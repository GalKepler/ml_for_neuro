

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Exercise V: Regularization &#8212; Machine Learning for Neuroscience</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/chapter_05/exercise_05';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Exercise VI: Revisiting Linear and Logistic Regression" href="../chapter_06/exercise_06.html" />
    <link rel="prev" title="Exercise IV: Logistic Regression" href="../chapter_04/exercise_04.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Machine Learning for Neuroscience - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Machine Learning for Neuroscience - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../content.html">Contents</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../chapter_01/exercise_01.html">Exercise I: Exploratory Data Analysis (EDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_02/exercise_02.html">Exercise II: k-Nearest Neighbors (k-NN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_03/exercise_03.html">Exercise III: Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catching_up/catching_up.html">Catching Up &amp; Happy Birthday</a></li>


<li class="toctree-l2"><a class="reference internal" href="../chapter_04/exercise_04.html">Exercise IV: Logistic Regression</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Exercise V: Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_06/exercise_06.html">Exercise VI: Revisiting Linear and Logistic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_07/exercise_07.html">Exercise VII: Decision Trees and Random Forests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_08/exercise_08.html">Exercise VIII: K-Means Clustering and PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter_09/exercise_09.html">Exercise IX: The Haxby Experiment (2001)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/GalKepler/ml_for_neuro" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/GalKepler/ml_for_neuro/issues/new?title=Issue%20on%20page%20%2Fchapters/chapter_05/exercise_05.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/chapter_05/exercise_05.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise V: Regularization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">Set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-inspection-and-preprocessing">General Inspection and Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-scatter-matrix">Pairwise Scatter-matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-encoding">Dummy Encoding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-creation">Model Creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-application">Model Application</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation">Model Evaluation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha">Alpha</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficients">Coefficients</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-squared-error-mse">Mean Squared Error (MSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-2"><span class="math notranslate nohighlight">\(R^2\)</span></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-v-regularization">
<h1>Exercise V: Regularization<a class="headerlink" href="#exercise-v-regularization" title="Permalink to this heading">#</a></h1>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>More information about the dataset can be found <a class="reference external" href="https://rdrr.io/cran/ISLR/man/Hitters.html">here</a>.</p>
</aside>
<p>This exercise is an adaptation of lab 2 from the <a class="reference external" href="http://faculty.marshall.usc.edu/gareth-james/ISL/ISLR%20Seventh%20Printing.pdf">ISLR</a>, in which the salary of baseball players is predicted on the basis of various statistics associated with performance in the previous year.</p>
<section id="set-up">
<h2>Set up<a class="headerlink" href="#set-up" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/JWarmenhoven/ISLR-python/master/Notebooks/Data/Hitters.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2092/4249813351.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
</pre></div>
</div>
</div>
</div>
</section>
<section id="general-inspection-and-preprocessing">
<h2>General Inspection and Preprocessing<a class="headerlink" href="#general-inspection-and-preprocessing" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>League</th>
      <th>Division</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>Salary</th>
      <th>NewLeague</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-Andy Allanson</th>
      <td>293</td>
      <td>66</td>
      <td>1</td>
      <td>30</td>
      <td>29</td>
      <td>14</td>
      <td>1</td>
      <td>293</td>
      <td>66</td>
      <td>1</td>
      <td>30</td>
      <td>29</td>
      <td>14</td>
      <td>A</td>
      <td>E</td>
      <td>446</td>
      <td>33</td>
      <td>20</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Alan Ashby</th>
      <td>315</td>
      <td>81</td>
      <td>7</td>
      <td>24</td>
      <td>38</td>
      <td>39</td>
      <td>14</td>
      <td>3449</td>
      <td>835</td>
      <td>69</td>
      <td>321</td>
      <td>414</td>
      <td>375</td>
      <td>N</td>
      <td>W</td>
      <td>632</td>
      <td>43</td>
      <td>10</td>
      <td>475.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Alvin Davis</th>
      <td>479</td>
      <td>130</td>
      <td>18</td>
      <td>66</td>
      <td>72</td>
      <td>76</td>
      <td>3</td>
      <td>1624</td>
      <td>457</td>
      <td>63</td>
      <td>224</td>
      <td>266</td>
      <td>263</td>
      <td>A</td>
      <td>W</td>
      <td>880</td>
      <td>82</td>
      <td>14</td>
      <td>480.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Andre Dawson</th>
      <td>496</td>
      <td>141</td>
      <td>20</td>
      <td>65</td>
      <td>78</td>
      <td>37</td>
      <td>11</td>
      <td>5628</td>
      <td>1575</td>
      <td>225</td>
      <td>828</td>
      <td>838</td>
      <td>354</td>
      <td>N</td>
      <td>E</td>
      <td>200</td>
      <td>11</td>
      <td>3</td>
      <td>500.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Andres Galarraga</th>
      <td>321</td>
      <td>87</td>
      <td>10</td>
      <td>39</td>
      <td>42</td>
      <td>30</td>
      <td>2</td>
      <td>396</td>
      <td>101</td>
      <td>12</td>
      <td>48</td>
      <td>46</td>
      <td>33</td>
      <td>N</td>
      <td>E</td>
      <td>805</td>
      <td>40</td>
      <td>4</td>
      <td>91.5</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>-Willie McGee</th>
      <td>497</td>
      <td>127</td>
      <td>7</td>
      <td>65</td>
      <td>48</td>
      <td>37</td>
      <td>5</td>
      <td>2703</td>
      <td>806</td>
      <td>32</td>
      <td>379</td>
      <td>311</td>
      <td>138</td>
      <td>N</td>
      <td>E</td>
      <td>325</td>
      <td>9</td>
      <td>3</td>
      <td>700.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Willie Randolph</th>
      <td>492</td>
      <td>136</td>
      <td>5</td>
      <td>76</td>
      <td>50</td>
      <td>94</td>
      <td>12</td>
      <td>5511</td>
      <td>1511</td>
      <td>39</td>
      <td>897</td>
      <td>451</td>
      <td>875</td>
      <td>A</td>
      <td>E</td>
      <td>313</td>
      <td>381</td>
      <td>20</td>
      <td>875.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Wayne Tolleson</th>
      <td>475</td>
      <td>126</td>
      <td>3</td>
      <td>61</td>
      <td>43</td>
      <td>52</td>
      <td>6</td>
      <td>1700</td>
      <td>433</td>
      <td>7</td>
      <td>217</td>
      <td>93</td>
      <td>146</td>
      <td>A</td>
      <td>W</td>
      <td>37</td>
      <td>113</td>
      <td>7</td>
      <td>385.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Upshaw</th>
      <td>573</td>
      <td>144</td>
      <td>9</td>
      <td>85</td>
      <td>60</td>
      <td>78</td>
      <td>8</td>
      <td>3198</td>
      <td>857</td>
      <td>97</td>
      <td>470</td>
      <td>420</td>
      <td>332</td>
      <td>A</td>
      <td>E</td>
      <td>1314</td>
      <td>131</td>
      <td>12</td>
      <td>960.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Wilson</th>
      <td>631</td>
      <td>170</td>
      <td>9</td>
      <td>77</td>
      <td>44</td>
      <td>31</td>
      <td>11</td>
      <td>4908</td>
      <td>1457</td>
      <td>30</td>
      <td>775</td>
      <td>357</td>
      <td>249</td>
      <td>A</td>
      <td>W</td>
      <td>408</td>
      <td>4</td>
      <td>3</td>
      <td>1000.0</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>322 rows × 20 columns</p>
</div></div></div>
</div>
<p>Well, it looks like a dataset.</p>
<p>Let’s probe a little deeper:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 322 entries, -Andy Allanson to -Willie Wilson
Data columns (total 20 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   AtBat      322 non-null    int64  
 1   Hits       322 non-null    int64  
 2   HmRun      322 non-null    int64  
 3   Runs       322 non-null    int64  
 4   RBI        322 non-null    int64  
 5   Walks      322 non-null    int64  
 6   Years      322 non-null    int64  
 7   CAtBat     322 non-null    int64  
 8   CHits      322 non-null    int64  
 9   CHmRun     322 non-null    int64  
 10  CRuns      322 non-null    int64  
 11  CRBI       322 non-null    int64  
 12  CWalks     322 non-null    int64  
 13  League     322 non-null    object 
 14  Division   322 non-null    object 
 15  PutOuts    322 non-null    int64  
 16  Assists    322 non-null    int64  
 17  Errors     322 non-null    int64  
 18  Salary     263 non-null    float64
 19  NewLeague  322 non-null    object 
dtypes: float64(1), int64(16), object(3)
memory usage: 52.8+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">info()</span></code> reveals that most (<span class="pasted-text">16</span>/<span class="pasted-text">19</span>) columns contain integers, except for <code class="docutils literal notranslate"><span class="pre">Salary</span></code> which is a <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">League</span></code>, <code class="docutils literal notranslate"><span class="pre">NewLeague</span></code>, and <code class="docutils literal notranslate"><span class="pre">Division</span></code> which are <code class="docutils literal notranslate"><span class="pre">object</span></code> (categorical). Even more importantly, it shows that <code class="docutils literal notranslate"><span class="pre">Salary</span></code> contains missing observations. Because <code class="docutils literal notranslate"><span class="pre">Salary</span></code> is our target variable, we don’t really have any use for these observations and would be better off simply dropping them from our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Done.</p>
<p>Next, we might give <code class="docutils literal notranslate"><span class="pre">describe()</span></code> a quick look:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;float_format&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.4g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>Salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>403.6</td>
      <td>107.8</td>
      <td>11.62</td>
      <td>54.75</td>
      <td>51.49</td>
      <td>41.11</td>
      <td>7.312</td>
      <td>2658</td>
      <td>722.2</td>
      <td>69.24</td>
      <td>361.2</td>
      <td>330.4</td>
      <td>260.3</td>
      <td>290.7</td>
      <td>118.8</td>
      <td>8.593</td>
      <td>535.9</td>
    </tr>
    <tr>
      <th>std</th>
      <td>147.3</td>
      <td>45.13</td>
      <td>8.757</td>
      <td>25.54</td>
      <td>25.88</td>
      <td>21.72</td>
      <td>4.794</td>
      <td>2287</td>
      <td>648.2</td>
      <td>82.2</td>
      <td>331.2</td>
      <td>323.4</td>
      <td>264.1</td>
      <td>279.9</td>
      <td>145.1</td>
      <td>6.607</td>
      <td>451.1</td>
    </tr>
    <tr>
      <th>min</th>
      <td>19</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>19</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>67.5</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>282.5</td>
      <td>71.5</td>
      <td>5</td>
      <td>33.5</td>
      <td>30</td>
      <td>23</td>
      <td>4</td>
      <td>842.5</td>
      <td>212</td>
      <td>15</td>
      <td>105.5</td>
      <td>95</td>
      <td>71</td>
      <td>113.5</td>
      <td>8</td>
      <td>3</td>
      <td>190</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>413</td>
      <td>103</td>
      <td>9</td>
      <td>52</td>
      <td>47</td>
      <td>37</td>
      <td>6</td>
      <td>1931</td>
      <td>516</td>
      <td>40</td>
      <td>250</td>
      <td>230</td>
      <td>174</td>
      <td>224</td>
      <td>45</td>
      <td>7</td>
      <td>425</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>526</td>
      <td>141.5</td>
      <td>18</td>
      <td>73</td>
      <td>71</td>
      <td>57</td>
      <td>10</td>
      <td>3890</td>
      <td>1054</td>
      <td>92.5</td>
      <td>497.5</td>
      <td>424.5</td>
      <td>328.5</td>
      <td>322.5</td>
      <td>192</td>
      <td>13</td>
      <td>750</td>
    </tr>
    <tr>
      <th>max</th>
      <td>687</td>
      <td>238</td>
      <td>40</td>
      <td>130</td>
      <td>121</td>
      <td>105</td>
      <td>24</td>
      <td>1.405e+04</td>
      <td>4256</td>
      <td>548</td>
      <td>2165</td>
      <td>1659</td>
      <td>1566</td>
      <td>1377</td>
      <td>492</td>
      <td>32</td>
      <td>2460</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Permalink to this heading">#</a></h3>
<p>I seems like there’s fairly large variabiliy in scale between the different features, and in any case regularization requires some form of standardization.</p>
<p>First, let’s differntiate the features matrix (<code class="docutils literal notranslate"><span class="pre">X</span></code>) from the target vector (<code class="docutils literal notranslate"><span class="pre">y</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_name</span> <span class="o">=</span> <span class="s2">&quot;Salary&quot;</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">target_name</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Only numeric columns should be standardized, so let’s also be sure to distinguish those from the categoricals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>And we’re all set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">numeric_features</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
    <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">numeric_features</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-6.02900499e-01  5.12541715e-01  6.28166822e-01 -5.62091638e-01
  1.29471156e+00 -1.48709250e+00 -7.18525607e-01 -5.48488684e-01
 -1.79734846e-02  1.15868202e+00 -1.37146739e+00  9.76516229e-02
 -1.11981274e+00 -1.41227625e+00  1.11787316e+00 -1.45308511e+00
 -1.88157816e+00  6.36442383e-02  1.52063438e-01  4.64931376e-01
  1.53276325e+00  1.24710122e+00 -5.41687207e-01  4.78534330e-01
  9.95446575e-01  7.43791930e-01  1.04453100e-01  1.21989531e+00
 -1.35786444e+00 -1.67605977e-01 -9.22569914e-01 -1.51429841e+00
 -1.26944524e+00 -1.01779059e+00  8.40486691e-02 -1.35106296e+00
  8.32211129e-01  3.62909222e-01 -1.28984967e+00  1.27430713e+00
 -4.37053079e-03  9.23242303e-03 -1.08580536e+00 -6.16503453e-01
  1.51916030e+00  8.40486691e-02 -1.69113681e+00 -1.14021718e+00
 -1.27624671e+00  1.23349827e+00 -1.39187182e+00  7.98203745e-01
 -6.30106407e-01  7.36990453e-01  7.02983068e-01  8.52615560e-01
  1.38460484e-01 -3.58047330e-01 -1.06392684e-01 -4.39665053e-01
 -1.01098911e+00  1.85923414e+00  1.43074110e+00 -5.07679822e-01
  1.58717507e+00 -8.40952191e-01 -1.69113681e+00  3.69710699e-01
 -6.09701976e-01  4.85335807e-01 -5.89297545e-01  7.30188976e-01
 -1.47201546e-01  1.09746873e+00  7.72471922e-02  1.38460484e-01
  6.21365345e-01 -1.16062161e+00  1.10427021e+00  1.61438097e+00
 -1.28304819e+00  2.54085592e-01 -5.34885730e-01  5.87357961e-01
  1.15868202e+00  1.30831451e+00  4.64931376e-01 -8.20547760e-01
  2.96368538e-02 -5.21282776e-01 -2.28819269e-01 -3.37642900e-01
  9.20630329e-01 -4.32863576e-01  7.23387499e-01 -8.27349237e-01
 -1.60804500e-01  1.22669679e+00  1.13147611e+00 -6.64113791e-01
 -1.24904081e+00 -8.54555145e-01  2.81291500e-01 -1.77275453e+00
 -1.48709250e+00  1.26070417e+00 -4.12459146e-01  2.33681161e-01
  1.33552042e+00  1.76401347e+00 -1.16742308e+00  5.12541715e-01
  8.45814083e-01 -1.65712942e+00  1.32871894e+00  6.34968299e-01
 -1.31705557e+00 -1.71834271e+00 -8.54555145e-01 -4.26062099e-01
  9.07027375e-01 -3.15764384e-02 -6.43709361e-01  1.44434405e+00
  1.19268941e+00 -1.62312204e+00  1.45794701e+00 -9.97386160e-01
 -6.02900499e-01  1.27430713e+00  2.43094612e-03 -6.02900499e-01
  1.72467869e-01  3.35703315e-01 -1.49389397e+00  1.27430713e+00
 -1.51429841e+00  2.54085592e-01  5.87357961e-01  1.00224805e+00
  9.95446575e-01 -8.20547760e-01  1.06346134e+00 -5.14481299e-01
  1.24029974e+00  6.75777160e-01 -4.05657669e-01  1.87963857e+00
 -8.47753668e-01  5.46549099e-01  1.86070823e-01 -8.20547760e-01
  5.94159438e-01 -1.39187182e+00  1.26070417e+00 -5.21282776e-01
  4.10519561e-01 -4.46466530e-01  1.22669679e+00 -1.27624671e+00
  1.50555734e+00  5.80556484e-01 -1.32385705e+00  2.28353769e-02
  5.87357961e-01  2.60887069e-01 -7.86540376e-01 -1.32385705e+00
 -6.84518222e-01 -5.00878345e-01  6.82578637e-01 -9.90584683e-01
 -2.60933619e+00 -2.01613361e-01 -1.31025410e+00 -7.11724130e-01
  1.17228498e+00 -1.54003023e-01 -7.86540376e-01 -2.35620746e-01
  9.75042145e-01  1.14507907e+00  7.50593407e-01 -3.03635515e-01
  8.32211129e-01 -6.16503453e-01  9.27431806e-01  2.26879684e-01
 -1.13341570e+00 -1.14021718e+00  4.71732853e-01 -6.43709361e-01
 -9.02165483e-01 -3.17238469e-01 -1.27624671e+00 -1.00418764e+00
  4.24122515e-01 -5.21282776e-01 -4.26062099e-01  1.38993224e+00
  1.04453100e-01 -1.88010407e-01  5.60152053e-01 -1.07220241e+00
 -1.35106296e+00 -3.78451761e-01  8.11806699e-01 -6.23304930e-01
  6.28166822e-01 -1.88837964e+00 -8.74959576e-01  1.51916030e+00
 -6.55838230e-02 -1.33065853e+00 -1.47201546e-01  3.76512176e-01
  9.88645098e-01 -7.86540376e-01  8.05005222e-01  7.36990453e-01
 -1.24904081e+00  8.05005222e-01  3.90115130e-01  1.20629236e+00
  8.59417037e-01  1.04305691e+00  2.40482638e-01  3.35703315e-01
  8.45814083e-01  1.55996916e+00  1.07706430e+00 -8.34150714e-01
  1.28791008e+00  1.92724891e+00 -2.42422223e-01 -9.56577299e-01
  1.62118245e+00 -9.42974345e-01  1.05665987e+00  7.91402268e-01
 -2.61613767e+00 -1.35106296e+00 -1.43268068e+00 -1.29665114e+00
  7.23387499e-01  1.18588793e+00  2.54085592e-01 -1.57551170e+00
 -1.88157816e+00 -8.47753668e-01  5.19343191e-01  1.33552042e+00
  1.40353519e+00 -2.96834038e-01 -1.13194161e-01  1.19949088e+00
  2.96368538e-02  1.28791008e+00  6.34968299e-01  6.00960914e-01
  4.85335807e-01  1.15188054e+00  1.54636621e+00]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-0.59567545  0.49225957  0.73648988 -0.46245892  1.35816704 -1.57259669
 -0.77329749 -0.59567545 -0.35144514  1.13613948 -1.2173526   0.11481273
 -1.06193331 -1.43938016  1.11393673 -1.37277189 -1.68361047 -0.35144514
  0.02600171  0.18142099  1.33596428  1.2249505  -0.77329749  0.47005682
  0.98072019  0.64767886  0.00379895  1.33596428 -1.30616363 -0.04060656
 -1.06193331 -1.48378567 -1.37277189 -0.88431127  0.53666508 -1.12854158
  0.84750366 -0.15162034 -1.2173526   1.33596428 -0.15162034 -0.12941758
 -1.10633883 -0.66228372  1.53578908  0.11481273 -1.4171774  -1.15074434
 -1.2173526   0.69208437 -1.2173526   0.75869264 -0.59567545  0.51446233
  0.31463753  0.64767886  0.24802926 -0.24043136 -0.10721483 -0.26263412
 -0.83990576  2.89015717  1.2249505  -0.55126994  1.46918082 -0.57347269
 -1.48378567  0.13701548 -0.55126994  0.33684028 -0.66228372  0.66988162
  0.24802926  0.89190917  0.15921824  0.04820446  0.95851744 -1.30616363
  1.0251257   2.00204695 -1.26175811  0.44785406 -0.70668923  0.38124579
  0.98072019  1.40257255  0.22582651 -0.68448647 -0.30703963 -0.50686443
 -0.26263412 -0.68448647  0.69208437 -0.52906718  0.40344855 -0.66228372
  0.27023202  1.11393673  1.35816704 -0.08501207 -1.19514985 -0.83990576
 -0.19602585 -1.52819118 -1.50598843  1.38036979 -0.10721483 -0.10721483
  0.80309815  2.04645246 -1.17294709  0.55886784  0.53666508 -1.52819118
  1.66900561  0.62547611 -0.83990576 -1.48378567 -0.48466167 -0.28483687
  0.86970642 -0.12941758 -0.30703963  1.2249505   1.46918082 -1.52819118
  2.04645246 -0.92871678 -0.70668923  1.09173397 -0.35144514 -0.77329749
 -0.37364789 -0.15162034 -1.35056914  1.69120837 -1.10633883  0.22582651
  0.93631468  1.40257255  0.86970642 -0.75109474  1.18054499 -0.37364789
  1.13613948  0.62547611 -0.50686443  2.55711584 -0.97312229  0.42565131
  0.42565131 -0.83990576  0.73648988 -1.23955536  0.91411193 -0.52906718
  0.44785406 -0.35144514  1.09173397 -1.19514985  1.58019459  0.51446233
 -1.15074434 -0.32924238  0.89190917  0.51446233 -0.95091954 -1.19514985
 -0.817703   -0.68448647  0.27023202 -1.06193331 -2.37189589 -0.30703963
 -1.43938016 -0.72889198  1.31376153  0.04820446 -0.70668923 -0.32924238
  0.64767886  0.98072019  0.80309815 -0.6178782   1.2249505  -0.55126994
  0.60327335  0.33684028 -1.23955536 -1.15074434  1.0251257  -0.79550025
 -0.68448647 -0.26263412 -1.15074434 -0.83990576  0.00379895 -0.88431127
  0.04820446  1.15834224 -0.15162034 -0.57347269  0.8253009  -0.70668923
 -1.23955536 -0.39585065  0.60327335 -0.88431127  0.24802926 -1.79462425
 -0.88431127  1.55799184 -0.48466167 -1.12854158 -0.15162034  0.11481273
  0.91411193 -0.99532505  1.2249505   0.20362375 -0.92871678  0.71428713
  0.09260997  0.8253009   1.13613948  0.75869264 -0.26263412 -0.10721483
  0.31463753  2.26848001  1.35816704 -0.70668923  0.98072019  2.33508828
 -0.10721483 -0.83990576  2.29068277 -0.88431127  0.73648988  0.27023202
 -2.30528762 -1.43938016 -1.35056914 -1.03973056  0.86970642  0.66988162
  0.11481273 -1.46158291 -1.68361047 -0.86210851  0.09260997  0.69208437
  1.73561388 -0.59567545  0.35904304  2.20187175  0.20362375  1.4247753
  0.42565131  0.62547611  0.40344855  0.80309815  1.38036979]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-0.5285512   0.72996619  0.95878753 -0.18531919 -0.87178322 -1.21501523
 -1.32942591 -0.64296187  0.61555552  1.0731982  -0.87178322  0.15791283
 -1.32942591 -0.5285512   0.95878753 -1.10060456 -0.41414053  0.50114484
 -0.98619389  0.50114484  0.72996619 -0.87178322 -0.87178322 -0.18531919
 -0.64296187  0.95878753 -0.64296187  0.61555552 -0.64296187 -0.18531919
 -0.75737255 -1.21501523 -0.5285512  -1.10060456 -0.5285512  -0.41414053
  0.15791283  0.2723235  -1.10060456  0.84437686  0.04350216  0.72996619
 -0.29972986 -0.64296187  1.53084089  1.41643022 -0.64296187 -1.32942591
 -1.21501523  2.21730492 -0.75737255  0.95878753 -0.98619389  1.64525156
  1.98848358  1.64525156 -0.64296187 -0.87178322  0.38673417 -0.87178322
 -0.5285512   2.21730492  1.98848358 -0.29972986  2.21730492  0.50114484
  0.04350216  0.15791283  0.15791283  1.75966223 -0.5285512   1.53084089
  0.15791283  1.41643022  1.75966223  0.38673417  0.61555552 -1.10060456
  1.18760888  2.21730492 -0.87178322  0.50114484  0.50114484  1.41643022
  2.21730492  2.56053694  0.04350216  0.2723235  -0.87178322 -0.98619389
  1.0731982   0.50114484 -0.75737255 -0.07090852 -1.10060456  0.15791283
 -0.75737255  0.38673417  1.0731982   0.2723235  -0.18531919 -0.5285512
 -1.21501523 -0.75737255 -0.87178322  3.24700097 -0.64296187 -1.10060456
  2.44612627  1.98848358 -0.29972986 -0.18531919  1.0731982  -0.41414053
 -0.18531919 -0.5285512   0.15791283 -0.87178322 -0.87178322 -0.64296187
  1.30201955 -0.98619389 -0.75737255  1.75966223 -0.5285512  -1.10060456
  0.95878753 -0.75737255  0.15791283  0.50114484 -0.07090852 -0.75737255
  0.04350216 -0.98619389 -0.75737255  0.95878753 -0.64296187  1.87407291
  1.0731982   0.15791283  1.98848358 -0.87178322  1.64525156  0.04350216
  0.04350216 -0.75737255  1.41643022  2.21730492 -1.32942591  0.95878753
 -0.41414053 -0.41414053 -0.07090852 -0.29972986  1.0731982   1.18760888
  1.87407291  0.72996619  0.95878753 -1.10060456 -0.87178322  0.84437686
  0.04350216 -0.41414053  0.2723235   0.72996619 -0.41414053 -0.98619389
 -0.98619389  0.84437686  1.87407291 -0.41414053 -1.32942591 -0.75737255
 -0.18531919 -0.64296187 -0.41414053 -0.29972986 -0.5285512  -0.29972986
 -1.10060456  0.72996619 -1.32942591  0.38673417  0.04350216 -0.29972986
  2.10289425 -0.29972986 -1.32942591 -0.64296187 -0.64296187 -1.32942591
 -0.75737255 -0.5285512  -0.87178322  0.15791283  2.44612627  0.15791283
 -0.29972986  1.87407291  0.72996619  1.0731982  -0.07090852 -0.75737255
 -0.41414053 -0.07090852 -0.41414053 -1.10060456 -0.41414053 -0.98619389
 -0.75737255  0.2723235  -1.21501523 -0.41414053  0.50114484  0.95878753
 -0.5285512  -0.98619389 -0.29972986  1.98848358 -0.75737255  0.50114484
  0.72996619  0.61555552 -0.98619389  1.0731982  -1.32942591 -0.41414053
 -1.21501523 -0.64296187  0.61555552 -0.98619389  1.30201955 -0.18531919
 -0.98619389 -1.21501523  0.2723235  -0.41414053 -1.10060456  0.61555552
 -1.21501523 -1.10060456 -0.18531919 -0.87178322 -0.18531919 -1.21501523
 -0.75737255 -0.98619389 -0.87178322 -0.87178322  0.72996619 -1.32942591
  0.84437686 -0.75737255 -1.21501523 -0.41414053 -0.07090852  1.18760888
 -0.5285512  -0.75737255 -0.98619389 -0.29972986 -0.29972986]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-1.2061115   0.44151497  0.40228577 -0.61767348  0.75534858 -1.24534071
 -1.2061115  -1.1276531  -0.22538146  2.04991224 -0.93150709 -0.26461066
 -0.97073629 -1.00996549  1.34378661 -1.2061115  -1.51994512  0.67689018
  0.00999375  0.20613976  0.71611938  1.46147422 -0.89227789 -0.18615226
  1.46147422  1.38301581  0.00999375  1.1084114  -1.24534071 -0.65690268
 -1.2061115  -1.55917432 -0.89227789 -1.0491947   0.08845215 -0.81381949
  0.63766098 -0.49998587 -0.97073629  0.99072379 -0.38229827 -0.22538146
 -1.0491947  -0.89227789  1.69684943  0.12768136 -1.32379911 -1.0884239
 -0.93150709  1.50070342 -1.00996549  0.48074417 -0.49998587  0.55920258
  0.91226539  1.22609901  0.08845215  0.00999375  0.16691056 -0.69613188
 -0.22538146  2.44220426  1.34378661 -0.18615226  1.34378661 -0.42152747
 -1.32379911  0.48074417 -0.61767348  0.83380699 -0.77459028  0.83380699
 -0.02923545  1.38301581  1.65762022  0.59843178  0.24536896 -0.53921507
  0.83380699  1.81453703 -1.40225751  0.59843178 -0.85304869  1.029953
  1.42224501  1.42224501  0.32382737 -0.38229827 -0.49998587 -0.97073629
 -0.22538146 -0.73536108  1.50070342  0.28459816 -0.49998587 -0.69613188
 -0.02923545  0.59843178  0.67689018 -0.18615226 -0.97073629 -1.28456991
 -0.34306906 -1.44148671 -1.24534071  2.04991224 -0.26461066  0.40228577
  1.1868698   2.08914144 -0.81381949 -0.26461066  0.24536896 -1.44148671
  0.99072379  0.12768136 -0.89227789 -1.1276531  -0.85304869 -0.26461066
  0.12768136  0.04922295 -0.69613188  1.1084114   0.48074417 -1.63763272
  1.69684943 -0.93150709 -0.77459028  1.38301581 -0.02923545 -1.24534071
 -0.53921507 -0.34306906 -1.36302831  1.1084114  -0.81381949  1.1476406
  0.55920258  1.53993262  1.1868698  -0.81381949  1.34378661 -0.14692306
  0.67689018  0.28459816  0.55920258  2.52066266 -0.93150709  0.44151497
  0.87303619 -0.85304869  0.87303619 -1.1276531   1.34378661 -0.06846465
  0.48074417 -0.49998587  1.57916182 -1.0884239   1.53993262  0.87303619
 -1.28456991 -0.30383986  0.36305657  0.51997337 -0.97073629 -1.1668823
 -1.44148671 -0.30383986  0.63766098 -1.0491947  -2.14761235 -0.73536108
 -1.1276531  -0.65690268  1.34378661  0.24536896 -0.81381949 -0.46075667
  0.12768136  1.97145384  0.48074417 -0.38229827  1.30455741 -0.46075667
  1.0691822   0.28459816 -1.55917432 -0.53921507  0.24536896 -0.85304869
 -0.77459028 -0.18615226 -1.28456991 -0.49998587  0.79457779 -0.49998587
 -0.38229827  2.95218388  0.40228577 -0.49998587 -0.14692306 -0.77459028
 -0.93150709 -0.18615226 -0.10769385 -0.89227789  0.08845215 -1.83377873
 -0.49998587  0.51997337 -0.65690268 -0.89227789 -0.18615226  0.16691056
  0.71611938 -1.1668823   1.0691822  -0.02923545 -1.36302831  0.71611938
 -0.02923545  0.44151497  1.0691822   0.12768136 -0.42152747 -0.06846465
  0.48074417  1.42224501  1.30455741 -0.49998587  0.55920258  1.42224501
 -0.26461066 -1.1276531   2.04991224 -1.1276531  -0.26461066 -0.06846465
 -2.06915394 -1.2061115  -1.32379911 -1.48071592  0.04922295  0.04922295
  0.83380699 -1.48071592 -1.59840352 -0.77459028 -0.18615226  1.53993262
  2.04991224 -0.69613188  0.48074417  2.04991224  0.44151497  1.0691822
  0.40228577  0.83380699  0.24536896  1.1868698   0.87303619]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-0.52206292  0.79405962  1.02631654 -0.36722498 -0.0188396  -1.68334752
 -1.06399573 -0.75431984  0.5618027   0.91018808 -0.98657676  0.36825527
 -1.56721906 -0.94786727  0.91018808 -1.68334752 -1.14141471 -0.13496806
 -0.32851549  0.40696475  1.95534421 -0.0188396  -1.29625265  0.17470783
 -0.56077241  1.68437781 -0.5994819   1.10373551 -1.02528625  0.32954578
 -1.02528625 -1.18012419 -1.25754317 -0.98657676 -0.09625857 -0.75431984
  0.71664065  0.44567424 -0.8704483   0.79405962  0.05857938  1.29728294
 -1.02528625 -0.40593446  1.142445    0.67793116 -1.10270522 -1.41238111
 -1.41238111  1.64566832 -1.14141471  1.33599243 -0.83173881  1.7230873
  1.29728294  1.76179678 -0.21238703 -0.8704483  -0.17367754 -0.8704483
 -0.63819138  2.38114857  1.21986397 -0.48335344  2.49727703 -0.25109652
 -0.8704483   0.21341732 -0.21238703  1.60695884 -0.63819138  1.7230873
  0.25212681  2.03276319  0.75535013 -0.17367754  1.25857346 -1.10270522
  1.25857346  2.18760113 -1.29625265  0.83276911  0.01986989  2.07147267
  1.91663473  2.18760113  0.09728886 -0.17367754 -0.5994819  -0.289806
 -0.21238703  0.13599835  0.25212681 -0.71561036 -0.289806   -0.0188396
 -0.0188396   1.25857346  1.4134114   0.25212681 -0.48335344 -0.56077241
 -1.06399573 -0.83173881 -1.56721906  2.18760113 -0.5994819  -0.75431984
  2.53598651  2.69082446 -1.10270522  0.79405962  0.87147859 -0.79302933
  0.87147859 -0.52206292 -0.0188396  -1.18012419 -0.52206292 -0.36722498
  1.4134114  -0.67690087 -0.75431984  2.14889165  1.02631654 -1.64463803
  2.26502011 -0.98657676  0.32954578  1.02631654 -0.09625857 -0.56077241
 -0.36722498 -0.32851549 -0.90915779  1.06502602 -1.10270522  1.33599243
  0.25212681  1.21986397  1.52953986 -0.8704483   1.7230873  -0.32851549
  1.06502602 -0.13496806  0.48438373  1.7230873  -0.98657676  0.52309321
 -0.25109652 -0.56077241 -0.17367754 -0.90915779  1.33599243  0.40696475
  1.64566832  0.32954578  0.83276911 -1.02528625  0.32954578  0.13599835
 -0.5994819  -0.83173881  1.02631654  0.98760705 -0.5994819  -1.4510906
 -0.83173881  0.05857938  0.75535013 -0.71561036 -1.99302341 -0.98657676
 -0.63819138 -1.10270522 -0.09625857 -0.25109652 -0.56077241 -0.36722498
 -0.17367754 -0.09625857  0.09728886 -0.13496806 -0.05754908 -0.40593446
  1.4134114   0.13599835 -1.02528625 -1.25754317 -0.13496806 -0.79302933
 -0.8704483  -0.25109652 -1.29625265 -0.5994819   1.33599243 -0.8704483
 -0.09625857  0.87147859  0.25212681  0.32954578  0.94889756 -0.48335344
 -0.94786727 -0.25109652 -0.289806   -1.14141471 -0.71561036 -1.60592855
 -0.36722498  0.94889756 -0.90915779 -1.02528625  0.13599835  0.21341732
 -0.17367754 -0.71561036 -0.21238703  1.4134114  -0.90915779  0.98760705
  0.09728886  0.63922167 -0.05754908  1.142445   -0.5994819  -0.71561036
 -0.25109652  0.17470783  0.83276911 -1.02528625  0.91018808  0.52309321
 -0.90915779 -1.10270522  0.29083629 -0.83173881  0.36825527 -0.289806
 -1.87689495 -1.33496214 -0.8704483  -1.14141471  0.01986989  0.29083629
  0.01986989 -1.4510906  -1.02528625 -0.79302933  0.75535013 -0.8704483
  1.80050627 -0.289806   -0.94786727  0.75535013 -0.40593446  1.87792524
 -0.13496806 -0.05754908 -0.32851549  0.32954578 -0.289806  ]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-0.0975271   1.6093726  -0.18979195 -0.51271892 -0.2820568  -0.92791074
 -1.57376468 -1.52763225  1.10191593  0.82512138 -0.65111619  0.27153229
 -0.88177832 -0.51271892  1.47097532 -1.20470528 -1.25083771  1.10191593
  0.96351866  1.51710775 -0.05139468  1.33257805 -0.88177832 -0.05139468
  1.84003472  2.25522654 -0.88177832  0.68672411 -1.34310256 -0.51271892
 -1.20470528 -0.37432165 -1.48149983 -0.88177832 -0.37432165 -1.48149983
  1.97843199 -0.88177832 -0.83564589 -0.0975271  -0.0975271  -0.97404316
 -0.2820568  -1.34310256  1.33257805 -1.15857286 -1.20470528 -1.38923498
 -0.88177832  0.96351866 -0.92791074  0.17926744 -0.69724862  0.50219441
  2.30135896  2.57815351 -1.29697013 -0.0975271  -0.0975271  -0.83564589
  0.08700259  0.54832684  1.56324017  0.68672411  0.68672411  0.27153229
 -0.88177832  0.31766472 -1.15857286  1.4248429  -0.42045407  0.91738623
 -0.23592438  1.65550502  1.2403132  -0.23592438  1.70163744 -1.06630801
  0.08700259 -0.00526225 -1.38923498  1.79390229 -0.18979195  0.96351866
  1.0557835   0.50219441 -0.51271892 -0.69724862  1.14804835 -0.97404316
  0.87125381 -0.00526225  1.28644563  0.27153229 -0.2820568  -0.55885135
 -0.4665865   0.04087017 -0.14365953 -0.74338104 -0.4665865  -1.06630801
 -0.55885135 -1.20470528 -1.06630801  1.28644563 -0.05139468  1.37871047
  1.10191593 -0.42045407  0.17926744  0.64059169 -0.00526225 -0.88177832
 -0.42045407 -0.69724862 -0.60498377 -1.02017559  0.17926744 -0.97404316
  0.27153229 -0.32818922 -0.69724862 -0.42045407  0.77898896 -1.15857286
  0.96351866 -0.42045407 -0.74338104 -0.69724862 -1.06630801 -1.15857286
  0.73285653  0.91738623 -1.06630801 -0.14365953 -0.88177832  1.2403132
 -0.2820568   2.43975623  1.37871047 -0.88177832  1.14804835 -0.37432165
  0.54832684  1.93229957  2.16296169 -0.32818922 -0.51271892  1.19418078
  0.77898896 -0.65111619 -0.18979195 -0.92791074  1.0557835  -0.14365953
  0.50219441 -0.92791074  1.00965108 -0.37432165  1.10191593 -0.32818922
 -1.02017559 -0.51271892  0.36379714 -0.37432165 -0.65111619 -1.34310256
 -0.23592438 -0.65111619  0.59445926 -1.06630801 -1.89669165  0.96351866
 -0.0975271  -0.69724862  0.73285653 -0.42045407 -1.20470528  0.36379714
 -1.34310256  1.10191593  1.74776987  1.00965108  1.65550502 -0.51271892
  0.64059169 -0.05139468 -0.51271892 -0.92791074 -0.55885135 -0.69724862
 -0.37432165 -0.0975271  -1.20470528  0.13313502  1.4248429   0.17926744
  0.22539987  2.20909411  2.34749138 -0.2820568  -0.05139468 -1.29697013
 -1.11244044  0.08700259  0.50219441 -0.78951347 -0.92791074 -1.66602953
  0.91738623  0.22539987 -0.23592438 -1.06630801 -0.88177832  1.2403132
  0.04087017 -1.15857286  0.96351866  0.08700259 -1.29697013  0.87125381
 -0.2820568  -0.92791074  0.27153229 -0.83564589  1.10191593  0.50219441
  0.45606199  0.82512138  0.54832684 -0.97404316  0.54832684 -0.65111619
  0.59445926 -0.51271892  0.50219441 -0.55885135  1.47097532 -0.92791074
 -1.85055922 -0.97404316 -0.78951347 -1.75829438  0.54832684 -0.32818922
  1.6093726  -1.20470528 -1.34310256 -0.42045407  0.13313502  0.87125381
  1.51710775 -0.18979195 -0.23592438  2.9472129  -0.32818922  0.73285653
 -0.18979195  2.43975623  0.50219441  1.70163744 -0.4665865 ]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 1.3978935  -0.90120024  0.77086793 -1.11020876  0.77086793 -1.11020876
 -0.90120024 -1.11020876  1.18888498  0.56185941  0.35285089 -0.69219172
 -0.27417468  1.18888498  1.60690202 -0.4831832   0.14384237 -1.31921729
 -1.31921729 -0.27417468  2.23392759 -0.27417468 -0.06516616  0.56185941
 -0.4831832   1.3978935  -0.90120024 -0.4831832  -0.06516616  1.3978935
 -1.11020876 -1.11020876 -0.69219172 -0.27417468 -0.90120024 -0.4831832
 -0.27417468  2.02491906 -1.11020876  0.35285089  0.97987645 -0.27417468
 -0.69219172  0.97987645 -0.27417468 -1.31921729  1.81591054 -0.69219172
 -0.69219172  2.02491906 -0.90120024 -0.69219172  2.02491906  1.3978935
  2.23392759  1.60690202  0.35285089 -0.69219172 -0.27417468 -0.69219172
  1.60690202 -0.4831832   0.77086793  0.35285089  1.3978935  -1.11020876
  1.81591054 -0.69219172 -0.4831832  -0.69219172 -1.31921729 -0.90120024
  0.97987645  1.3978935  -0.90120024 -0.06516616  0.56185941  0.14384237
  1.3978935  -0.4831832  -1.31921729  1.3978935  -0.4831832   1.18888498
 -0.90120024 -0.27417468 -0.69219172  1.81591054  0.35285089  0.14384237
  1.60690202  2.65194463 -0.4831832  -0.4831832   0.77086793 -0.4831832
  0.14384237 -0.4831832  -0.06516616 -0.06516616 -0.4831832   2.23392759
 -0.69219172  0.35285089 -0.90120024 -0.27417468  1.60690202 -1.11020876
 -1.11020876 -0.69219172  0.97987645  2.02491906 -0.27417468  1.3978935
 -0.4831832   0.77086793  1.60690202 -1.11020876 -1.31921729  0.56185941
  0.56185941 -0.4831832   1.18888498 -0.90120024 -0.27417468 -0.90120024
  1.18888498  1.3978935  -0.90120024 -0.69219172 -0.27417468 -0.69219172
  1.18888498 -0.90120024  0.77086793 -0.4831832  -1.31921729  0.14384237
  1.3978935   1.18888498 -0.27417468  0.56185941 -0.69219172 -1.11020876
  0.35285089  0.56185941 -0.06516616 -0.90120024 -1.31921729 -0.06516616
 -1.11020876  0.97987645  1.60690202 -0.27417468 -0.06516616  0.56185941
  1.18888498 -0.90120024  0.56185941 -1.31921729 -0.4831832  -0.06516616
 -1.11020876 -1.11020876  1.18888498 -0.27417468  0.35285089 -1.31921729
 -0.90120024 -0.27417468 -0.90120024 -0.90120024 -1.11020876 -0.06516616
 -0.90120024 -0.90120024 -0.69219172 -0.06516616 -0.69219172 -0.4831832
 -1.11020876 -1.11020876  0.35285089 -0.06516616 -0.69219172  1.3978935
 -1.31921729  0.35285089  3.48797872 -0.4831832  -0.27417468 -0.4831832
  0.97987645 -0.4831832   0.97987645  1.81591054 -0.90120024  2.23392759
  0.35285089  0.14384237  2.65194463 -0.4831832   0.77086793 -0.27417468
  0.97987645  0.56185941  0.35285089 -1.31921729 -0.06516616 -0.69219172
 -0.27417468 -0.27417468 -0.69219172 -0.90120024 -1.31921729  0.97987645
 -1.31921729  0.56185941  1.18888498 -0.27417468 -0.90120024 -0.69219172
 -1.11020876 -1.11020876 -0.27417468  2.23392759 -0.69219172 -1.11020876
 -0.69219172 -0.27417468  0.14384237  0.14384237 -0.27417468 -0.69219172
  0.14384237 -0.69219172 -0.4831832  -0.06516616  0.14384237 -0.69219172
 -1.31921729 -0.06516616 -0.27417468  2.02491906 -0.06516616 -0.90120024
 -0.4831832   0.56185941  2.44293611 -0.69219172 -0.06516616 -1.11020876
 -0.27417468 -0.06516616 -0.06516616 -0.4831832  -1.31921729 -1.31921729
 -0.4831832   0.97987645 -0.27417468  0.14384237  0.77086793]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 3.46790505e-01 -4.52865385e-01  1.30155773e+00 -9.90935212e-01
  7.66993244e-01 -1.07068172e+00 -9.41422272e-01 -1.01503443e+00
  1.11665100e+00  8.64704621e-01 -3.42447147e-01 -5.01940158e-01
 -3.13966253e-01  2.51269965e-01  2.37068670e+00 -9.54567300e-01
 -8.45901732e-01 -9.83486362e-01 -9.77790183e-01 -3.21415102e-01
  2.52667437e+00  1.64121260e-02 -3.18347929e-01 -1.43080884e-01
 -1.53158739e-01  1.11446016e+00 -9.05492527e-01 -4.43225698e-01
 -5.90888183e-01  1.55525678e+00 -1.01109092e+00 -1.06279470e+00
 -8.60361264e-01 -7.26720142e-01 -7.56077372e-01 -8.33194872e-01
 -4.18175172e-03  1.69284141e+00 -1.06542371e+00  7.97664976e-01
  1.09211361e+00 -7.48190355e-01 -5.79495825e-01  4.75173615e-01
  2.42068446e-01 -9.82171859e-01  1.74103984e+00 -6.75892699e-01
 -7.58706378e-01  2.14196321e+00 -9.39231433e-01 -8.07342983e-01
  2.44911870e+00  1.17843263e+00  2.23616924e+00  1.75418487e+00
  4.35300362e-01 -6.13234731e-01 -2.11873199e-01 -6.98239247e-01
  1.60082621e+00 -1.90402986e-01  1.03383732e+00  5.12856029e-01
  1.78310393e+00 -9.76913848e-01  1.20559902e+00 -5.72923311e-01
 -5.26039376e-01 -3.71366210e-01 -1.02555045e+00 -9.05054360e-01
 -2.29838071e-01  2.02847780e+00 -8.52912414e-01 -2.31152574e-01
  1.29980506e+00 -5.72923311e-01  1.50837284e+00 -2.31590742e-01
 -1.07024355e+00  1.76031922e+00 -5.04569163e-01  1.49216064e+00
 -7.32854489e-01  8.95861170e-02 -8.16982670e-01  1.83261687e+00
  4.01123288e-01 -2.26770898e-01  1.89658934e+00  2.65461931e+00
 -5.20781365e-01 -5.00187487e-01  1.27263867e+00 -4.41911195e-01
  2.01757025e-01 -1.31250359e-01  4.80431626e-01  1.29897537e-01
 -6.45220967e-01  1.98422287e+00 -8.93662002e-01 -8.84460482e-01
 -9.34849757e-01 -1.45709890e-01  7.36321511e-01 -9.71655837e-01
 -8.59484928e-01 -5.30421052e-01  7.65678741e-01  2.10953880e+00
 -7.24892500e-03 -2.32028909e-01 -7.69175751e-02  5.31697236e-01
  6.05747563e-01 -1.03825731e+00 -1.04263899e+00  1.34279213e-01
  3.78823389e-02 -8.70877286e-01  8.59008442e-01 -5.34802729e-01
  1.73276131e-01 -1.07856873e+00  1.95837098e+00  5.48785773e-01
 -8.88403991e-01 -2.79351011e-01 -5.71170640e-01 -9.67274161e-01
  1.28490736e+00 -7.49066690e-01  2.93334056e-01 -4.24384491e-01
 -1.08514125e+00  2.86808191e-02  1.51976520e+00  1.50399117e+00
  6.94304069e-02  5.52729282e-01 -3.80567730e-01 -1.01459626e+00
  1.85982991e-01  3.35398147e-01 -7.65278892e-01 -3.19662432e-01
 -1.04220082e+00  1.52682253e-01 -8.72191789e-01  7.98103144e-01
  7.15727633e-01 -8.11724659e-01  3.94550774e-01  7.07840616e-01
  1.38962942e+00 -8.65619275e-01  8.96690856e-01 -1.06980538e+00
 -4.21317317e-01 -2.65767815e-01 -1.06980538e+00 -7.39865170e-01
  3.25320292e-01 -5.44004248e-01  6.89922393e-02 -1.07287255e+00
 -1.01371993e+00 -3.19662432e-01 -6.89037728e-01 -8.84898650e-01
 -1.14648471e+00 -3.02135727e-01 -9.46242115e-01 -9.10312371e-01
 -8.04275809e-01  1.56625761e-01 -4.44102033e-01 -6.13234731e-01
 -7.09631605e-01 -7.35921662e-01  9.12026723e-01 -5.10265342e-01
 -4.82660783e-01  1.41416680e+00 -9.27839076e-01  6.49126156e-01
  4.99311985e+00 -6.13672899e-01 -3.03012062e-01 -1.00933825e+00
  9.97031239e-01 -5.53643936e-01  6.06670547e-02  1.92813741e+00
 -8.78764303e-01  5.65874310e-01 -1.43080884e-01  6.19330759e-01
  3.01041141e+00 -3.88892914e-01  5.73761327e-01 -7.64840724e-01
  1.08510293e+00 -1.61922092e-01  3.11298928e-01 -1.02774129e+00
  3.06917252e-01 -1.05972753e+00 -7.43370511e-01  2.14025719e-01
 -6.87285057e-01 -8.78326136e-01 -9.97069558e-01  1.17887080e+00
 -9.23895567e-01  1.07159470e-02  1.91893589e+00 -3.97656266e-01
 -1.03738098e+00 -8.44587230e-01 -8.66495610e-01 -8.00332301e-01
 -4.55056223e-01  2.67346052e+00 -8.52912414e-01 -9.42298607e-01
 -4.12553965e-01  1.80724980e-01  2.29361585e-01  1.99924385e-04
  4.70838588e-02 -4.99311152e-01 -3.33245628e-01 -7.75356747e-01
 -1.28621353e-01 -5.78619490e-01  2.21036400e-01 -7.58268210e-01
 -1.15612440e+00 -7.90254446e-01 -6.66691179e-01  6.14949083e-01
  9.39677931e-02 -5.51453098e-01 -4.87042459e-01  6.25903273e-01
  2.51440568e+00 -5.68979802e-01  1.63636443e-01 -6.22874418e-01
  3.08716572e-02 -1.70685444e-01 -3.86702076e-01  5.27800377e-02
 -9.85677200e-01 -9.04616192e-01  1.99174669e-02  1.25029212e+00
 -4.19564647e-01  2.36810434e-01  9.86077049e-01]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 0.1743734  -0.4098921   1.31817358 -0.96015272  0.63498482 -1.0513476
 -0.94933299 -0.98333786  0.94257433  0.8931127  -0.39443534 -0.51036103
 -0.32797127  0.15891664  2.39705537 -0.95860705 -0.83804433 -0.97406381
 -0.94778732 -0.36043047  2.69227947  0.03835392 -0.35733911 -0.18267774
 -0.13785313  1.01985813 -0.88596028 -0.41762048 -0.64019781  1.82979231
 -0.99570327 -1.03898219 -0.86895784 -0.75148647 -0.69429646 -0.81949621
 -0.01110771  1.61494336 -1.02507111  0.90393243  1.0925049  -0.75921485
 -0.60155591  0.3799483   0.31657559 -0.94160461  1.40936846 -0.69893349
 -0.79167405  1.94726368 -0.93078488 -0.79940243  2.28112968  1.04304327
  1.89316502  1.64276552  0.50051102 -0.57064239 -0.25841586 -0.66801997
  1.45110171  0.02289716  1.02913218  0.34903478  2.01218207 -0.94160461
  0.95184839 -0.65565457 -0.49026724 -0.38825263 -0.99570327 -0.86277514
 -0.1981345   2.10337695 -0.83186162 -0.27541829  1.47892388 -0.59691888
  1.33053899 -0.17340368 -1.03743652  2.12192506 -0.57373374  1.42791657
 -0.71439025  0.00898608 -0.82722459  1.83597501  0.22228935 -0.23832207
  1.93180692  2.2409421  -0.54591158 -0.53509185  1.32281061 -0.4160748
  0.27484234 -0.13321611  0.54842697  0.15427961 -0.65410889  2.1002856
 -0.9168738  -0.88286893 -0.9230565  -0.13630746  0.72772538 -0.95706137
 -0.84886406 -0.49181292  0.7586389   2.20230021 -0.07911745 -0.27696397
 -0.01110771  0.53142454  0.6303478  -1.01116003 -0.98333786  0.13264015
  0.01207743 -0.85813811  0.93948298 -0.53354617  0.24392882 -1.04825625
  2.22703102  0.39695073 -0.88286893 -0.28005532 -0.61392132 -0.94933299
  1.04304327 -0.77930864  0.25938558 -0.40216372 -1.02661679  0.04299095
  1.72623202  1.7277777   0.14345988  0.52524183 -0.38979831 -0.97097245
  0.24392882  0.38303965 -0.78549134 -0.20895423 -1.01734273  0.18828448
 -0.82722459  0.77254998  0.80037215 -0.82104189  0.31812126  0.61952807
  1.28262303 -0.83031595  0.92402622 -1.03279949 -0.38052425 -0.26768991
 -1.02661679 -0.76076053  0.42940993 -0.50108698 -0.0373842  -1.03279949
 -0.99879462 -0.31869722 -0.71593593 -0.85350108 -1.10235491 -0.31406019
 -0.93696758 -0.86895784 -0.75766918  0.17282773 -0.48563022 -0.61701267
 -0.69738782 -0.73139269  0.69062916 -0.56136834 -0.38979831  1.26871195
 -0.90759974  0.74318214  5.46213072 -0.60773861 -0.24141342 -0.98952057
  0.98276191 -0.58455347 -0.0883915   1.73550608 -0.89678001  0.3351237
 -0.09921124  0.71072294  2.76338056 -0.48563022  0.58706887 -0.75457783
  0.92866325 -0.16722098  0.26711396 -1.01116003  0.24702017 -1.04052787
 -0.74839512  0.27793369 -0.70357052 -0.85350108 -0.96015272  0.99976434
 -0.88596028 -0.08530015  2.00445369 -0.47944751 -0.99261192 -0.83031595
 -0.86895784 -0.79167405 -0.45780805  2.87621491 -0.88750595 -0.92614785
 -0.4933586   0.23156341  0.18364746 -0.10075691 -0.05593231 -0.42380318
 -0.35424776 -0.77621729  0.07390447 -0.59228185  0.23465476 -0.76539756
 -1.11008329 -0.77776296 -0.72057296  0.65353294  0.15273394 -0.56445969
 -0.50263265  0.66126132  2.59644756 -0.56755104  0.07545014 -0.63865213
  0.04762798 -0.24141342 -0.33415398  0.39540506 -0.93542191 -0.85040973
  0.1295488   1.21925032 -0.44698832  0.20837827  1.13578382]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-2.91979923e-03 -7.60538181e-02  1.89856469e+00 -6.97692979e-01
 -6.12369957e-01 -8.31772013e-01 -8.43961017e-01 -7.70826998e-01
  2.23985678e+00  2.53049267e-01 -6.61125969e-01 -3.44211887e-01
 -7.95205004e-01 -4.05156903e-01  1.31349254e+00 -7.83016001e-01
 -5.51424941e-01 -6.48936966e-01 -8.07394007e-01 -2.72978055e-02
  1.15503550e+00 -6.36747963e-01 -6.85503976e-01 -1.00431824e-01
 -4.53912916e-01  1.17941351e+00 -7.46448991e-01 -3.07644878e-01
 -5.14857932e-01  9.35633443e-01 -7.83016001e-01 -7.95205004e-01
 -4.53912916e-01 -5.87991950e-01 -5.51424941e-01 -4.53912916e-01
  9.45922260e-02  2.58114887e+00 -8.19583010e-01  5.33396339e-01
  1.17941351e+00 -4.90479925e-01 -2.46699862e-01 -4.17345906e-01
  7.77176402e-01 -5.51424941e-01  3.50561292e-01 -8.31772013e-01
 -7.34259988e-01  2.99557498e+00 -7.46448991e-01 -5.75802947e-01
  3.74939298e-01  1.84980868e+00  3.38562308e+00  2.70303890e+00
 -4.53912916e-01 -6.48936966e-01  1.31159235e-01 -7.09881982e-01
  1.03314547e+00  2.89616276e-01  2.39831382e+00  9.23444440e-01
  2.16672276e+00 -5.39235938e-01  1.36224855e+00 -5.02668928e-01
 -5.02668928e-01  4.72451324e-01 -7.58637994e-01 -5.02668928e-01
 -3.44211887e-01  2.87368494e+00 -2.95455875e-01 -3.80778897e-01
  2.50801485e+00 -7.58637994e-01  7.52798396e-01  2.77427273e-01
 -7.95205004e-01  1.70354064e+00  2.14582071e-02  2.45925884e+00
 -1.97943850e-01  4.60262320e-01 -6.73314972e-01  2.31299080e+00
 -1.24809831e-01 -6.48936966e-01  1.97169871e+00  3.83661619e+00
 -6.97692979e-01 -3.32022884e-01 -3.07644878e-01  4.58362134e-02
  2.77427273e-01 -1.36998834e-01  8.62499424e-01 -1.73565843e-01
 -3.56400891e-01  1.47194958e+00 -8.31772013e-01 -6.48936966e-01
 -7.58637994e-01  7.16231387e-01  9.26920392e-03 -8.19583010e-01
 -3.80778897e-01 -1.49187837e-01  1.52070559e+00  1.02095647e+00
  3.38372289e-01 -1.61376840e-01 -5.14857932e-01 -3.56400891e-01
  3.38372289e-01 -7.34259988e-01 -7.95205004e-01  1.43348239e-01
  3.38372289e-01 -7.95205004e-01 -1.49187837e-01 -5.16758118e-02
 -4.53912916e-01 -8.19583010e-01  3.43437909e+00 -4.41723913e-01
 -5.51424941e-01 -2.10132853e-01 -4.78290922e-01 -7.70826998e-01
  1.67726245e-01 -7.70826998e-01  5.80252165e-02 -3.56400891e-01
 -7.70826998e-01  6.91853380e-01  6.30908365e-01  7.16231387e-01
  5.82152352e-01  1.92104251e-01 -5.16758118e-02 -6.97692979e-01
  1.67726245e-01 -6.00180954e-01 -6.38648150e-02 -4.17345906e-01
 -8.43961017e-01  5.69963349e-01 -7.34259988e-01  3.01805279e-01
  1.79915248e-01 -4.78290922e-01  3.99317305e-01  1.74010765e+00
  1.71572964e+00 -4.05156903e-01  2.89616276e-01 -8.19583010e-01
 -6.97692979e-01 -8.82428213e-02 -6.97692979e-01 -6.73314972e-01
  5.33396339e-01 -2.71077869e-01 -1.73565843e-01 -8.07394007e-01
 -8.07394007e-01  2.53049267e-01 -1.85754846e-01 -6.36747963e-01
 -8.19583010e-01 -5.27046935e-01 -6.73314972e-01 -7.46448991e-01
 -6.12369957e-01 -3.56400891e-01 -6.48936966e-01 -1.85754846e-01
 -8.07394007e-01 -4.05156903e-01 -6.85503976e-01 -1.00431824e-01
 -3.80778897e-01  4.23695311e-01 -4.78290922e-01  1.18970232e-01
  1.10627949e+00 -5.51424941e-01 -4.90479925e-01 -8.43961017e-01
 -2.58888865e-01 -3.19833881e-01 -3.19833881e-01  2.95900797e+00
 -3.07644878e-01  1.06781229e-01 -2.34510859e-01  4.11506308e-01
  5.83561271e+00  5.57774346e-01 -2.72978055e-02 -6.97692979e-01
 -1.61376840e-01 -3.19833881e-01 -3.68589894e-01 -8.19583010e-01
 -4.05156903e-01 -8.07394007e-01 -6.48936966e-01  5.80252165e-02
 -8.07394007e-01 -6.36747963e-01 -6.48936966e-01  1.04533447e+00
 -7.58637994e-01 -3.80778897e-01  1.02095647e+00  3.74939298e-01
 -7.83016001e-01 -5.75802947e-01 -5.51424941e-01 -5.87991950e-01
 -7.09881982e-01  2.45925884e+00 -8.31772013e-01 -7.46448991e-01
 -6.97692979e-01 -6.12369957e-01 -1.00431824e-01 -2.58888865e-01
  7.77176402e-01 -6.61125969e-01 -7.34259988e-01 -7.34259988e-01
 -5.14857932e-01 -4.53912916e-01 -6.48936966e-01 -5.75802947e-01
 -8.31772013e-01 -6.97692979e-01 -3.32022884e-01  1.67726245e-01
 -7.60538181e-02 -7.58637994e-01 -6.36747963e-01 -1.49187837e-01
  2.10577775e+00 -4.66101919e-01  4.96829330e-01 -8.31772013e-01
 -2.91979923e-03 -3.44211887e-01 -7.70826998e-01 -4.53912916e-01
 -7.09881982e-01 -5.75802947e-01 -4.53912916e-01 -3.68589894e-01
 -7.58637994e-01  3.38372289e-01 -4.78290922e-01]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-1.21670863e-01 -4.15104914e-01  1.41205144e+00 -9.47521336e-01
  4.22845932e-01 -1.00197302e+00 -9.68696989e-01 -9.95922829e-01
  1.27894734e+00  1.03088969e+00 -5.11907900e-01 -4.72581687e-01
 -1.57971983e-01  4.47092688e-02  2.06849669e+00 -8.96094750e-01
 -8.90044563e-01 -8.74919097e-01 -9.26345683e-01 -3.60653234e-01
  1.95656824e+00  2.44365427e-01 -2.12423662e-01 -3.48552861e-01
 -3.69682505e-02  1.21542038e+00 -8.50718350e-01 -4.30230381e-01
 -7.11564058e-01  1.50582934e+00 -9.89872642e-01 -1.03222395e+00
 -8.32567790e-01 -7.66015738e-01 -7.50890271e-01 -7.38789898e-01
 -2.78929706e-02  1.94144277e+00 -9.95922829e-01  8.25183342e-01
  1.16701889e+00 -7.93241577e-01 -5.96610512e-01  1.44537348e-01
  5.07548545e-01 -9.17270403e-01  1.01878931e+00 -7.41814991e-01
 -7.35764805e-01  2.35890565e+00 -9.20295496e-01 -7.93241577e-01
  1.78111283e+00  1.06114062e+00  2.46175882e+00  2.18042514e+00
  3.01842200e-01 -4.99807527e-01 -2.30574222e-01 -7.20639338e-01
  1.98984427e+00 -3.69682505e-02  1.36667504e+00  6.46702837e-01
  1.86581544e+00 -9.08195123e-01  1.16399379e+00 -6.08710886e-01
 -6.20811259e-01 -2.09398569e-01 -9.86847549e-01 -8.29542697e-01
 -2.24524036e-01  2.34075509e+00 -6.20811259e-01 -7.93195568e-02
  1.58145667e+00 -5.90560326e-01  1.15491851e+00 -1.94273103e-01
 -1.03524904e+00  2.15017421e+00 -5.02832620e-01  1.46952822e+00
 -6.45012005e-01 -6.67130844e-04 -7.84166298e-01  1.67523456e+00
  2.05039214e-01 -4.39305660e-01  2.14412402e+00  2.45268354e+00
 -3.45527768e-01 -2.33599316e-01  1.03391478e+00 -4.54431127e-01
  2.50415614e-01 -2.91076088e-01  3.95620092e-01 -1.45871610e-01
 -6.54087285e-01  1.73573643e+00 -8.74919097e-01 -8.50718350e-01
 -9.17270403e-01  2.95838022e-02  6.64853397e-01 -8.90044563e-01
 -7.87191391e-01 -4.57456220e-01  1.03088969e+00  1.87186563e+00
 -2.66875342e-01 -1.73097449e-01 -9.44450234e-02  2.68566174e-01
  5.52924944e-01 -9.56596616e-01 -9.92897736e-01  5.37845487e-02
 -1.79147636e-01 -8.23492511e-01  7.70731663e-01 -5.45183926e-01
  1.44583357e-02 -1.03827414e+00  2.24697720e+00  4.74272518e-01
 -8.87019470e-01 -1.54946890e-01 -5.24008273e-01 -9.77772269e-01
  6.55778117e-01 -8.02316857e-01  1.74788281e-01 -4.30230381e-01
 -9.89872642e-01  2.17139587e-01  1.88094091e+00  1.83858960e+00
  1.32436975e-01  4.34946305e-01 -3.87879074e-01 -9.38446056e-01
  5.38305577e-03  1.41512255e-01 -6.38961819e-01 -3.00151368e-01
 -9.98947922e-01  2.26214867e-01 -7.38789898e-01  5.92251157e-01
  7.67706569e-01 -7.50890271e-01  4.59147052e-01  6.52753024e-01
  1.14584323e+00 -8.26517604e-01  1.09744174e+00 -1.01104830e+00
 -4.39305660e-01 -1.85197823e-01 -1.02012358e+00 -7.26689525e-01
  2.53440707e-01 -4.57456220e-01 -1.39821423e-01 -1.01709848e+00
 -1.03222395e+00 -3.45527768e-01 -6.38961819e-01 -8.50718350e-01
 -1.07457526e+00 -5.45183926e-01 -9.14245310e-01 -8.77944190e-01
 -6.93413498e-01  2.71591267e-01 -4.93757340e-01 -5.45183926e-01
 -7.02488778e-01 -5.84510139e-01  6.70903583e-01 -5.60309393e-01
 -3.51577955e-01  1.17911926e+00 -8.44668164e-01  9.52237261e-01
  5.45660120e+00 -5.90560326e-01 -3.36452488e-01 -9.68696989e-01
  8.13082969e-01 -5.54259206e-01 -2.88050995e-01  1.82648923e+00
 -7.84166298e-01  2.32265054e-01 -3.39477581e-01  1.51490462e+00
  3.47213999e+00 -3.72753608e-01  1.47562441e-01 -7.84166298e-01
  8.52409182e-01 -2.00323289e-01  4.77343621e-02 -9.95922829e-01
  1.14332424e-02 -1.04432432e+00 -7.05513872e-01  4.01670279e-01
 -8.08367044e-01 -7.96266671e-01 -9.41471150e-01  1.06416571e+00
 -8.71894003e-01 -1.39821423e-01  2.06244650e+00 -4.75606780e-01
 -1.01104830e+00 -8.11392137e-01 -8.62818724e-01 -7.72065924e-01
 -4.33255474e-01  2.34983037e+00 -8.87019470e-01 -9.02144937e-01
 -4.54431127e-01  1.77813374e-01  2.68566174e-01 -1.12595583e-01
  2.35336156e-02 -4.99807527e-01 -4.66531500e-01 -8.41643070e-01
 -2.78929706e-02 -6.84338218e-01  1.80838468e-01 -7.72065924e-01
 -1.08667563e+00 -7.75091018e-01 -7.02488778e-01  3.83519719e-01
 -1.64022169e-01 -6.41986912e-01 -4.09054727e-01  6.58803210e-01
  2.07757197e+00 -5.48209020e-01 -7.02442769e-02 -4.84682060e-01
  1.14286415e-01 -2.48724782e-01 -2.69900435e-01  3.41168413e-01
 -8.93069657e-01 -8.44668164e-01  5.37845487e-02  1.62078288e+00
 -4.36280567e-01  3.29068040e-01  1.25172150e+00]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 0.25896561 -0.19959036  1.57266648 -0.88122761  0.01729422 -0.9958666
 -0.90911277 -0.91840782  1.73378074  0.53781721 -0.44745845 -0.39168813
 -0.70462159 -0.12522993  2.05291091 -0.95248968 -0.76968697 -0.87503091
 -0.89052266 -0.24606563  2.29768065 -0.41027824 -0.68912984 -0.01059094
 -0.45985186  1.25043797 -0.88122761 -0.37929473 -0.61476941  1.4642242
 -0.93389958 -0.93389958 -0.78827707 -0.66124468 -0.64885127 -0.69222819
  0.03588433  2.00333729 -0.92460452  0.72061992  1.03975009 -0.5961793
 -0.46914691 -0.02918105  0.43866997 -0.80996553  1.02425834 -0.82545729
 -0.80996553  2.62920422 -0.89981772 -0.70462159  1.79264941  1.50140441
  2.54554874  1.91658346 -0.09114807 -0.68293314 -0.17480355 -0.68912984
  0.86004573  0.21868704  1.52309287  0.61217764  2.36274602 -0.80686718
  1.4704209  -0.64265457 -0.53111393  0.03898268 -0.91530947 -0.68293314
 -0.11283653  2.79961353 -0.65504798 -0.48463866  2.12107463 -0.64575292
  1.12340557 -0.03537775 -0.96798144  2.22951692 -0.34521286  2.07150102
 -0.48773702  0.21868704 -0.77588367  2.28218889  0.1071464  -0.37929473
  1.93517357  2.90185912 -0.63335952 -0.58688425  0.58429247 -0.15621344
  0.27445736 -0.0446728   0.80117705  0.14432661 -0.54660569  2.34725427
 -0.92770288 -0.7232117  -0.90911277  0.14122826  0.28065406 -0.92460452
 -0.62096611 -0.33591781  1.16058578  2.1737466   0.16291672 -0.19339366
 -0.01368929  0.1133431   0.40768646 -0.90291607 -0.90601442  0.30234252
  0.06376949 -0.87503091  0.59358753 -0.32042605  0.02039257 -0.99276825
  2.97002284 -0.019886   -0.73250675 -0.32352441 -0.60547436 -0.88122761
  0.77019354 -0.80067048  0.15981837 -0.41957329 -0.95248968  0.27755571
  1.16678249  1.76476425  0.44486667  0.38909635 -0.21818047 -0.88742431
  0.45416173 -0.08495137 -0.54040898 -0.40098318 -0.94319463  0.39529306
 -0.82545729  0.47275183  0.30853922 -0.65504798  0.43557162  1.14509403
  1.57886319 -0.67673643  0.59358753 -0.94629298 -0.51872053 -0.20888541
 -0.90911277 -0.80996553  0.49753864 -0.39478648 -0.01678764 -0.98037484
 -0.91221112 -0.13142664 -0.50632712 -0.79137543 -1.0020633  -0.40717989
 -0.85334245 -0.92150617 -0.76658862 -0.25226233 -0.65194963 -0.47534361
 -0.77588367 -0.74180181  0.13503156 -0.39788483 -0.50632712  1.18847094
 -0.75109686  0.18460518  3.04748162 -0.63645787 -0.24296728 -0.92460452
  0.32403098 -0.42886834 -0.08185302  2.47118831 -0.68603149  0.15362167
 -0.0260827   0.26826066  4.11641276 -0.09734477  0.51612875 -0.72631005
  0.35501449 -0.1779019  -0.14382004 -0.95558804 -0.15621344 -0.9834732
 -0.70152324  0.04517938 -0.80376883 -0.8564408  -0.85334245  1.02115998
 -0.87812926 -0.22127882  1.53858462 -0.16860685 -0.92770288 -0.69532654
 -0.79137543 -0.75729356 -0.56209744  3.00100635 -0.8502441  -0.90291607
 -0.5713925  -0.311131    0.03588433 -0.09424642  0.16601507 -0.59927766
 -0.52181888 -0.76968697 -0.311131   -0.51872053  0.05757278 -0.77588367
 -1.01445671 -0.717015   -0.59308095  0.49753864  0.02968762 -0.52491723
 -0.56209744  0.1009497   3.15282556 -0.56519579  0.2341788  -0.80996553
  0.11024475 -0.22747552 -0.63645787 -0.0260827  -0.89671936 -0.71391665
 -0.06016456  0.3736046  -0.73560511  0.27755571  0.08235959]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 0.43533435  0.010373    0.3556541  -0.86231547 -0.25143354 -0.89646415
 -0.94199573 -0.95717292  2.29833453  0.86408999 -0.37664536 -0.21728486
 -0.20210767 -0.08448444  1.78989864 -0.83954969 -0.77504663 -0.74089795
 -0.75228084 -0.07689584  0.53778039  0.21526508 -0.30455371 -0.35767388
  0.1811164   1.98720212 -0.86990407 -0.47150281 -0.73710365  1.1790167
 -0.91922994 -0.8167839  -0.86610977 -0.53980017 -0.68398348 -0.79401811
  0.10902474  1.36114299 -0.88508126  0.22285368  1.00827331 -0.74469224
 -0.25143354 -0.34249668  0.20008789 -0.92681853  1.96064204 -0.77125233
 -0.55497736  1.77092715 -0.83954969 -0.69157208  1.63053813  1.09174786
  4.24860356  2.76503315 -0.56256595 -0.54359446 -0.28178792 -0.77884092
  2.12379684 -0.33870239  1.3535544   1.42185176  0.89065008 -0.74848654
  2.33248321 -0.52462298 -0.69916067  0.02555019 -0.86610977 -0.71813216
 -0.12622171  2.0137622  -0.61189182 -0.00859848  1.70262979 -0.58533174
  0.15076202 -0.54359446 -0.94579002  1.64950962 -0.17554758  1.59259516
 -0.62706901 -0.13760461 -0.79781241  1.08415926  0.56813477 -0.63465761
  2.50702091  3.0230454  -0.23625635 -0.1565761  -0.01618708 -0.46391421
 -0.07689584 -0.4790914   0.010373   -0.27799362 -0.50185719  1.45220614
 -0.80540101 -0.75607514 -0.8091953  -0.08448444  0.24561946 -0.71813216
 -0.72572075 -0.72951505  1.38390878  2.25280296 -0.13001601  0.14317342
 -0.38802826 -0.07310155  1.10313075 -0.85472688 -0.8167839  -0.1489875
 -0.32731949 -0.78263522  0.66678651 -0.67639488 -0.16037039 -0.91922994
  1.15245662  0.46189443 -0.77884092 -0.6422462  -0.74848654 -0.88128696
  1.45600044 -0.6422462   0.16593921 -0.67639488 -0.90405275  0.1849107
  1.28905134  2.49184372  0.22285368  0.08625896 -0.39941115 -0.86231547
  0.13179053  0.58331196 -0.27799362 -0.6422462  -0.87369837  0.44292294
 -0.6536291   0.1773221   0.30253393 -0.6574234   0.3442712   0.27976814
  0.72749527 -0.79781241  1.19798819 -0.86231547 -0.35767388 -0.40699975
 -0.91543564 -0.72951505  0.15455632 -0.47150281 -0.27040503 -0.94199573
 -0.8167839  -0.37664536 -0.55497736 -0.85093258 -0.97235011  0.10523045
 -0.69157208 -0.8205782  -0.68777778 -0.35008528 -0.55877165 -0.39182255
 -0.89646415 -0.60430323  1.0158619  -0.3235252  -0.32731949  1.04242199
 -0.77884092  0.39359707  4.95434294 -0.58912604 -0.3121423  -0.88887556
  0.54157469 -0.47150281 -0.23625635  2.76882745 -0.60050893  0.78061544
  0.05211028  1.69883549  4.10442025 -0.39182255  0.09005326 -0.68398348
  0.75405536  0.03313879  0.13558483 -0.89646415 -0.36146817 -0.93440713
 -0.33490809 -0.06930725 -0.69916067 -0.75228084 -0.90405275  1.80128153
 -0.82816679 -0.21349056  1.04242199 -0.39941115 -0.93061283 -0.66121769
 -0.80160671 -0.83575539 -0.36905677  0.82614702 -0.61189182 -0.76745803
 -0.39941115  0.05211028  0.42774575 -0.308348    0.23044227 -0.6498348
 -0.23625635 -0.66121769 -0.25522784 -0.50185719  0.37462559 -0.79022382
 -0.983733   -0.71813216 -0.58533174 -0.06171865 -0.32731949 -0.6574234
 -0.26281643  0.55295758  2.12000254 -0.38802826 -0.08069014 -0.57015455
  0.09764185 -0.05413006 -0.25143354  0.59469485 -0.85852118 -0.77125233
 -0.46391421  2.33248321 -0.43355983  0.27217955 -0.04274716]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 1.22149851e+00  2.10910888e+00 -3.24661483e-01  1.84067833e+00
 -3.11774095e-02 -7.68466667e-01 -6.07408334e-01 -5.28668705e-01
 -1.04047630e+00 -1.88656668e-01  4.75622200e-02 -2.85291668e-01
 -6.07408334e-01 -7.54150371e-01 -6.64673519e-01 -6.75410741e-01
 -3.17503335e-01 -3.83355576e-02  2.51569442e-01  8.13484070e-01
  2.77839573e+00  5.12841849e-01 -2.45921853e-01  1.57940592e+00
 -1.02758891e-01 -8.48635204e-02 -2.31605557e-01 -6.50357223e-01
  4.59155738e-01 -7.82782963e-01  5.41474441e-01  1.26301849e-01
  5.82994422e-02  2.44411294e-01 -7.79203889e-01 -8.32890000e-01
  4.39831459e-02  3.51783516e-01 -6.50357223e-01 -8.00678334e-01
  9.05111088e-02 -4.64245371e-01 -5.32247779e-01 -6.61094445e-01
 -1.81498520e-01 -3.13924261e-01 -8.50785371e-01 -5.93092038e-01
 -7.79203889e-01 -1.04047630e+00 -4.96457038e-01 -6.57515371e-01
 -4.92877964e-01 -6.14566482e-01  1.85141555e+00 -3.83355576e-02
 -2.38763705e-01 -2.31605557e-01 -3.89084816e-01 -6.68252593e-01
 -8.57943519e-01  3.88790869e+00  4.39831459e-02 -5.26518539e-02
 -4.54937057e-02 -5.10773334e-01 -4.49929075e-01 -1.60024076e-01
  8.67170181e-01 -2.31605557e-01 -8.79417963e-01 -4.78561668e-01
 -8.29310926e-01  4.61333121e-03 -5.98100020e-02  4.61333121e-03
  2.69965610e+00 -6.75410741e-01  9.05111088e-02 -7.77053723e-02
 -6.25303704e-01 -6.93306112e-01  1.55793148e+00  2.06973907e+00
  3.44410351e+00 -6.18145556e-01 -2.24447409e-01 -5.25089631e-01
 -3.11774095e-02 -7.14780556e-01 -5.50143149e-01 -7.43413149e-01
  6.13055922e-01 -3.78347594e-01 -2.99607964e-01  1.35750333e+00
 -1.92235742e-01  1.44197220e-01  1.53505534e-02 -6.25303704e-01
 -8.61522593e-01 -1.04047630e+00 -4.54937057e-02 -5.46564075e-01
 -6.93306112e-01  2.76622960e-01 -2.85291668e-01 -5.26518539e-02
  1.01248331e-01 -1.77919446e-01  1.18928685e+00 -1.92235742e-01
  2.12700425e+00 -9.22366852e-01 -2.13710187e-01  4.75622200e-02
 -1.04047630e+00 -9.40262222e-01 -6.75410741e-01 -4.74982594e-01
 -7.11201482e-01 -2.85291668e-01 -4.64245371e-01 -6.46778149e-01
 -3.83355576e-02  1.47776294e-01  1.40618146e-01 -7.29096852e-01
  7.41902589e-01 -2.54481692e-03 -2.45921853e-01 -2.28026483e-01
  1.41476851e+00 -1.49286854e-01 -8.65101667e-01  4.39831459e-02
 -7.25517778e-01 -3.60452224e-01 -6.96885186e-01  3.25083351e+00
  3.31883592e+00 -5.21510557e-01  1.47776294e-01 -5.21510557e-01
 -3.92663890e-01 -8.07836482e-01 -1.04047630e+00  4.94946478e-01
 -6.57515371e-01  3.36536388e+00 -2.75983354e-02 -4.82140742e-01
 -1.85077594e-01 -1.99393891e-01  2.87360182e-01  6.88216478e-01
 -1.04047630e+00 -1.04047630e+00 -5.26518539e-02  9.40901829e-02
  4.39831459e-02  6.90366644e-02 -3.21082409e-01 -4.24875557e-01
 -1.04047630e+00 -2.06552039e-01 -1.13496113e-01 -6.75410741e-01
  6.34530367e-01 -5.07194260e-01 -6.71831667e-01  2.40832220e-01
 -7.61308519e-01  1.66530370e+00  6.16634997e-01 -2.81712594e-01
  1.22722775e-01 -2.24447409e-01 -3.13924261e-01 -5.07194260e-01
 -1.06337965e-01  1.22722775e-01 -2.20868335e-01  1.40045222e+00
 -1.45707780e-01 -8.32890000e-01 -4.78561668e-01 -7.46992223e-01
  8.31379441e-01 -4.24875557e-01  1.98742036e+00 -6.21724630e-01
 -8.18573704e-01 -4.42770927e-01  3.58941664e-01 -8.93734259e-01
 -1.68611132e-02  1.31813351e+00 -1.42128706e-01  4.84209256e-01
 -1.04047630e+00 -1.04047630e+00 -7.25517778e-01 -8.82997037e-01
 -4.85719816e-01 -8.25731852e-01  2.73043886e-01 -7.32675926e-01
 -4.85719816e-01 -3.60452224e-01 -3.92663890e-01  6.54575903e-02
 -3.13924261e-01 -8.90155185e-01 -3.24661483e-01 -1.04047630e+00
 -1.27812409e-01 -5.57301297e-01  2.19357775e-01  3.38325925e+00
 -3.47564835e-02  3.68390147e+00 -6.43199075e-01  1.04827405e-01
 -3.38977779e-01  3.11124962e+00 -2.20868335e-01 -6.12389099e-03
 -2.92449816e-01  2.73043886e-01  2.15778701e-01 -6.61094445e-01
  8.69320347e-02  1.17714793e-02 -2.92449816e-01 -7.50571297e-01
  1.65671664e-01 -7.11201482e-01  2.19357775e-01 -7.89941112e-01
  1.43624296e+00 -5.71617593e-01  2.96668497e-02 -4.03401112e-01
  1.85857370e+00 -5.64459445e-01 -4.67824446e-01 -8.07836482e-01
 -4.42770927e-01 -5.64459445e-01 -7.04043334e-01  3.32459237e-02
  3.18998925e+00 -4.32033705e-01 -3.74768520e-01 -6.07408334e-01
  2.33101147e+00  3.33315221e+00  1.22722775e-01  7.97738866e-02
 -9.08050556e-01  3.66242703e+00  4.19785923e-01]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[-0.52319133 -0.25386267 -0.74417894 -0.54390892  2.08722487  0.05690116
  1.13421578  1.18255682 -0.82014344  2.25296558 -0.5093796  -0.74417894
  0.22264187 -0.5093796   1.18255682  0.40219431 -0.66821445 -0.75799067
 -0.66821445 -0.44032097  0.26407705 -0.75799067 -0.79942585 -0.24695681
  1.45188548 -0.78561412 -0.77180239  1.19636855 -0.50247374  0.35385327
 -0.41269752 -0.61987341 -0.64749686 -0.61296755  0.40219431 -0.79251998
 -0.75799067 -0.55081478 -0.77180239  0.19501842 -0.77870826 -0.75108481
 -0.72346135  0.60246433  2.50848251 -0.33673303 -0.2124275   0.55412329
  0.22954773 -0.82014344 -0.79942585  0.8510754   0.719864    0.67152296
 -0.07431024 -0.75108481  1.15493337 -0.77180239 -0.75799067  0.65080537
 -0.44722684 -0.12955714 -0.77870826 -0.77870826 -0.75799067 -0.79251998
 -0.75799067  1.86623725 -0.54390892 -0.75108481  0.02237185 -0.77180239
  0.25717119 -0.75799067 -0.80633171 -0.77870826 -0.2124275   0.09143047
  2.2115304  -0.70274377 -0.78561412  0.68533469 -0.21933336 -0.39197993
 -0.05359265  1.48641479  1.7833669  -0.77870826  2.54301182  0.45744121
 -0.78561412  0.38147672 -0.75799067 -0.76489653  1.6521555  -0.42650925
 -0.76489653 -0.68202618 -0.71655549  0.71295814  0.11905393 -0.82014344
  2.04578969 -0.71655549 -0.80633171 -0.68202618 -0.43341511 -0.77180239
 -0.79251998 -0.76489653 -0.57843823 -0.78561412 -0.09502783 -0.79942585
  1.76264931  1.57619101 -0.82014344 -0.43341511 -0.79251998 -0.79251998
  0.95466334 -0.75799067 -0.79942585  1.30686235  2.48776492 -0.68893204
 -0.70964963  0.32622982 -0.55081478  2.21843627 -0.78561412 -0.71655549
 -0.50247374  2.24605972 -0.80633171 -0.73727308 -0.82014344 -0.80633171
 -0.78561412  0.20883014 -0.10193369 -0.78561412 -0.75799067 -0.41269752
 -0.73036722  0.96156921 -0.82014344 -0.76489653  0.59555847 -0.2676744
 -0.76489653 -0.80633171 -0.76489653 -0.66821445 -0.77870826 -0.48866201
 -0.82014344 -0.82014344  2.08722487 -0.57153237  2.28749489 -0.75799067
 -0.77870826  1.36901512 -0.82014344 -0.77180239 -0.61296755 -0.77870826
 -0.49556788 -0.76489653  1.13421578 -0.59915582  0.69914641 -0.37816821
 -0.59915582 -0.81323757 -0.73727308 -0.77180239 -0.79942585 -0.81323757
  2.34964766 -0.73036722  2.30821248 -0.17789818 -0.74417894  0.15358324
 -0.77870826  0.35385327 -0.52319133 -0.81323757 -0.24005095  1.0375337
 -0.19861577 -0.80633171 -0.51628547 -0.00525161 -0.76489653 -0.4541327
 -0.75799067 -0.79251998 -0.82014344 -0.82014344  0.58865261 -0.82014344
 -0.79942585  0.39528844  2.46014147  0.21573601  1.74193172 -0.80633171
 -0.79942585  2.57754114  1.72812    -0.17099232 -0.77180239 -0.82014344
  2.28749489  0.95466334 -0.75799067 -0.14336887 -0.67512031  0.32622982
  0.74058159  2.39108284  1.62453205 -0.4541327   1.98363692  1.99054279
  1.74883758  2.16318936  2.23224799  0.17430083 -0.75108481  2.25296558
  0.87869885  0.19501842 -0.68893204 -0.78561412  2.03888383  0.17430083
 -0.33673303 -0.77870826 -0.73036722 -0.5093796  -0.136463    1.74193172
  1.18255682 -0.82014344 -0.6958379   0.37457086  1.04443956 -0.73727308
 -0.15718059  1.14112164  1.18255682  1.02372197 -0.3229213   0.13977152
 -0.75799067  1.81099035 -0.03978092  0.08452461 -0.79251998]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
/tmp/ipykernel_2092/1039181100.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#39;[ 0.21335208  0.81996395 -0.84821868 -0.69656571  2.48814657 -0.24160682
  0.06169912  1.57822878 -1.30317758  2.03318767  0.36500505 -0.24160682
 -0.39325978 -0.08995385  0.21335208  1.12326988 -0.99987165 -0.54491275
 -0.99987165 -0.84821868  0.81996395 -0.84821868 -0.84821868  0.66831098
  1.12326988 -0.84821868 -0.69656571  2.48814657 -0.54491275  2.33649361
 -0.39325978 -0.54491275 -1.15152461 -0.69656571  1.42657581 -0.69656571
  0.06169912 -0.69656571 -0.84821868 -0.69656571 -0.54491275 -0.84821868
 -0.99987165 -0.24160682  0.66831098  0.21335208 -0.84821868  0.66831098
  0.36500505 -1.30317758 -0.54491275  2.18484064  0.21335208  0.51665801
 -0.99987165 -0.54491275 -0.08995385 -0.84821868 -0.69656571  0.06169912
 -0.08995385 -0.39325978 -0.39325978 -0.99987165  0.06169912 -0.99987165
 -1.15152461  1.42657581 -0.69656571 -0.39325978  2.63979954 -0.08995385
  0.06169912 -0.54491275 -0.24160682 -0.84821868  0.66831098  0.21335208
  0.21335208  0.21335208  0.51665801  1.12326988 -0.84821868 -0.08995385
  0.36500505  1.88153471  2.63979954 -0.54491275  1.57822878  0.51665801
  0.06169912  1.12326988 -0.24160682 -0.69656571  1.72988174 -0.54491275
 -1.15152461 -0.69656571 -0.54491275  0.97161691  1.72988174 -1.30317758
  1.12326988 -1.15152461 -0.99987165 -0.84821868  0.66831098  0.06169912
  0.81996395 -0.39325978 -0.84821868 -0.69656571 -0.08995385 -1.30317758
  1.42657581  0.21335208 -1.30317758 -0.99987165 -0.99987165 -0.54491275
  1.72988174 -0.84821868 -0.84821868  0.97161691 -0.54491275 -0.99987165
 -0.08995385  0.81996395  0.66831098  2.48814657 -0.54491275 -0.84821868
 -0.69656571  1.12326988 -1.30317758 -0.54491275 -0.84821868 -0.99987165
 -0.84821868 -0.54491275  0.21335208 -0.24160682 -0.08995385 -0.08995385
 -0.69656571 -0.08995385 -1.30317758 -0.39325978  1.12326988 -0.24160682
 -0.84821868 -0.99987165 -0.99987165 -0.54491275 -0.39325978 -0.39325978
 -1.30317758 -1.30317758  0.36500505 -1.15152461  0.81996395  0.06169912
 -0.84821868  2.48814657 -1.30317758 -0.24160682  0.21335208 -0.84821868
 -0.39325978 -0.39325978  1.57822878 -0.08995385 -0.39325978  0.97161691
 -0.08995385 -0.99987165 -0.08995385 -0.54491275 -0.84821868 -0.39325978
  2.03318767 -0.84821868  0.97161691  0.66831098 -1.15152461  2.18484064
  0.81996395  0.97161691 -0.39325978 -0.69656571  0.06169912  0.51665801
 -0.84821868 -0.69656571 -0.69656571 -0.08995385 -0.08995385 -0.24160682
 -0.69656571 -0.39325978 -1.30317758 -1.30317758  1.12326988 -1.15152461
 -0.99987165 -0.39325978  1.57822878  0.97161691  3.09475844  0.06169912
 -0.99987165 -0.54491275  1.12326988  0.66831098 -0.39325978 -1.30317758
  1.27492284 -0.24160682 -1.15152461  1.42657581 -0.84821868  1.27492284
  0.36500505  3.54971734  0.97161691 -0.24160682  2.03318767 -0.39325978
  1.27492284  1.12326988  1.27492284 -0.24160682 -0.39325978  0.66831098
 -0.84821868 -0.69656571 -0.69656571 -0.84821868  0.06169912  0.36500505
 -0.08995385 -1.15152461 -0.54491275 -0.69656571  1.42657581  1.72988174
  0.36500505 -1.30317758 -0.39325978  0.06169912  1.12326988  0.06169912
  0.66831098 -0.84821868  1.27492284  1.57822878  0.36500505  0.97161691
 -0.84821868  1.72988174 -0.24160682  0.51665801 -0.84821868]&#39; has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  X.loc[:, numeric_features.columns] = scaler.fit_transform(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>League</th>
      <th>Division</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>NewLeague</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-Alan Ashby</th>
      <td>-0.6029</td>
      <td>-0.5957</td>
      <td>-0.5286</td>
      <td>-1.206</td>
      <td>-0.5221</td>
      <td>-0.09753</td>
      <td>1.398</td>
      <td>0.3468</td>
      <td>0.1744</td>
      <td>-0.00292</td>
      <td>-0.1217</td>
      <td>0.259</td>
      <td>0.4353</td>
      <td>N</td>
      <td>W</td>
      <td>1.221</td>
      <td>-0.5232</td>
      <td>0.2134</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Alvin Davis</th>
      <td>0.5125</td>
      <td>0.4923</td>
      <td>0.73</td>
      <td>0.4415</td>
      <td>0.7941</td>
      <td>1.609</td>
      <td>-0.9012</td>
      <td>-0.4529</td>
      <td>-0.4099</td>
      <td>-0.07605</td>
      <td>-0.4151</td>
      <td>-0.1996</td>
      <td>0.01037</td>
      <td>A</td>
      <td>W</td>
      <td>2.109</td>
      <td>-0.2539</td>
      <td>0.82</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Andre Dawson</th>
      <td>0.6282</td>
      <td>0.7365</td>
      <td>0.9588</td>
      <td>0.4023</td>
      <td>1.026</td>
      <td>-0.1898</td>
      <td>0.7709</td>
      <td>1.302</td>
      <td>1.318</td>
      <td>1.899</td>
      <td>1.412</td>
      <td>1.573</td>
      <td>0.3557</td>
      <td>N</td>
      <td>E</td>
      <td>-0.3247</td>
      <td>-0.7442</td>
      <td>-0.8482</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Andres Galarraga</th>
      <td>-0.5621</td>
      <td>-0.4625</td>
      <td>-0.1853</td>
      <td>-0.6177</td>
      <td>-0.3672</td>
      <td>-0.5127</td>
      <td>-1.11</td>
      <td>-0.9909</td>
      <td>-0.9602</td>
      <td>-0.6977</td>
      <td>-0.9475</td>
      <td>-0.8812</td>
      <td>-0.8623</td>
      <td>N</td>
      <td>E</td>
      <td>1.841</td>
      <td>-0.5439</td>
      <td>-0.6966</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Alfredo Griffin</th>
      <td>1.295</td>
      <td>1.358</td>
      <td>-0.8718</td>
      <td>0.7553</td>
      <td>-0.01884</td>
      <td>-0.2821</td>
      <td>0.7709</td>
      <td>0.767</td>
      <td>0.635</td>
      <td>-0.6124</td>
      <td>0.4228</td>
      <td>0.01729</td>
      <td>-0.2514</td>
      <td>A</td>
      <td>W</td>
      <td>-0.03118</td>
      <td>2.087</td>
      <td>2.488</td>
      <td>A</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>-Willie McGee</th>
      <td>0.635</td>
      <td>0.4257</td>
      <td>-0.5286</td>
      <td>0.4023</td>
      <td>-0.135</td>
      <td>-0.1898</td>
      <td>-0.4832</td>
      <td>0.01992</td>
      <td>0.1295</td>
      <td>-0.4539</td>
      <td>0.05378</td>
      <td>-0.06016</td>
      <td>-0.4639</td>
      <td>N</td>
      <td>E</td>
      <td>0.1227</td>
      <td>-0.758</td>
      <td>-0.8482</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Willie Randolph</th>
      <td>0.601</td>
      <td>0.6255</td>
      <td>-0.7574</td>
      <td>0.8338</td>
      <td>-0.05755</td>
      <td>2.44</td>
      <td>0.9799</td>
      <td>1.25</td>
      <td>1.219</td>
      <td>-0.3686</td>
      <td>1.621</td>
      <td>0.3736</td>
      <td>2.332</td>
      <td>A</td>
      <td>E</td>
      <td>0.07977</td>
      <td>1.811</td>
      <td>1.73</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Wayne Tolleson</th>
      <td>0.4853</td>
      <td>0.4034</td>
      <td>-0.9862</td>
      <td>0.2454</td>
      <td>-0.3285</td>
      <td>0.5022</td>
      <td>-0.2742</td>
      <td>-0.4196</td>
      <td>-0.447</td>
      <td>-0.7586</td>
      <td>-0.4363</td>
      <td>-0.7356</td>
      <td>-0.4336</td>
      <td>A</td>
      <td>W</td>
      <td>-0.9081</td>
      <td>-0.03978</td>
      <td>-0.2416</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Upshaw</th>
      <td>1.152</td>
      <td>0.8031</td>
      <td>-0.2997</td>
      <td>1.187</td>
      <td>0.3295</td>
      <td>1.702</td>
      <td>0.1438</td>
      <td>0.2368</td>
      <td>0.2084</td>
      <td>0.3384</td>
      <td>0.3291</td>
      <td>0.2776</td>
      <td>0.2722</td>
      <td>A</td>
      <td>E</td>
      <td>3.662</td>
      <td>0.08452</td>
      <td>0.5167</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Wilson</th>
      <td>1.546</td>
      <td>1.38</td>
      <td>-0.2997</td>
      <td>0.873</td>
      <td>-0.2898</td>
      <td>-0.4666</td>
      <td>0.7709</td>
      <td>0.9861</td>
      <td>1.136</td>
      <td>-0.4783</td>
      <td>1.252</td>
      <td>0.08236</td>
      <td>-0.04275</td>
      <td>A</td>
      <td>W</td>
      <td>0.4198</td>
      <td>-0.7925</td>
      <td>-0.8482</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>263 rows × 19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.013e-17</td>
      <td>5.741e-17</td>
      <td>3.377e-17</td>
      <td>-5.066e-17</td>
      <td>1.216e-16</td>
      <td>1.689e-18</td>
      <td>-5.403e-17</td>
      <td>6.079e-17</td>
      <td>6.754e-17</td>
      <td>5.403e-17</td>
      <td>3.377e-17</td>
      <td>4.053e-17</td>
      <td>1.081e-16</td>
      <td>7.43e-17</td>
      <td>0</td>
      <td>1.047e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.616</td>
      <td>-2.372</td>
      <td>-1.329</td>
      <td>-2.148</td>
      <td>-1.993</td>
      <td>-1.897</td>
      <td>-1.319</td>
      <td>-1.156</td>
      <td>-1.11</td>
      <td>-0.844</td>
      <td>-1.087</td>
      <td>-1.014</td>
      <td>-0.9837</td>
      <td>-1.04</td>
      <td>-0.8201</td>
      <td>-1.303</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.8239</td>
      <td>-0.8066</td>
      <td>-0.7574</td>
      <td>-0.8334</td>
      <td>-0.8317</td>
      <td>-0.8356</td>
      <td>-0.6922</td>
      <td>-0.7953</td>
      <td>-0.7886</td>
      <td>-0.6611</td>
      <td>-0.7736</td>
      <td>-0.7294</td>
      <td>-0.7181</td>
      <td>-0.6343</td>
      <td>-0.7649</td>
      <td>-0.8482</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.06364</td>
      <td>-0.1072</td>
      <td>-0.2997</td>
      <td>-0.1077</td>
      <td>-0.1737</td>
      <td>-0.1898</td>
      <td>-0.2742</td>
      <td>-0.3183</td>
      <td>-0.3187</td>
      <td>-0.3564</td>
      <td>-0.3365</td>
      <td>-0.3111</td>
      <td>-0.3273</td>
      <td>-0.2388</td>
      <td>-0.5094</td>
      <td>-0.2416</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.8322</td>
      <td>0.7476</td>
      <td>0.73</td>
      <td>0.7161</td>
      <td>0.7554</td>
      <td>0.7329</td>
      <td>0.5619</td>
      <td>0.5402</td>
      <td>0.5129</td>
      <td>0.2835</td>
      <td>0.4123</td>
      <td>0.2915</td>
      <td>0.2589</td>
      <td>0.1138</td>
      <td>0.5058</td>
      <td>0.6683</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.927</td>
      <td>2.89</td>
      <td>3.247</td>
      <td>2.952</td>
      <td>2.691</td>
      <td>2.947</td>
      <td>3.488</td>
      <td>4.993</td>
      <td>5.462</td>
      <td>5.836</td>
      <td>5.457</td>
      <td>4.116</td>
      <td>4.954</td>
      <td>3.888</td>
      <td>2.578</td>
      <td>3.55</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Try to consider the way in which standardization was applied. Can you think of anything that could pose a problem in following steps?</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Solution<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Applying standardization prior to the train-test split results in information (mean and standard deviation) from the test set “leaking” into the training set, and therefore should be avoided! The correct procedure is to apply standardization separately after splitting the data.</p>
</div>
</details></div>
</section>
<section id="pairwise-scatter-matrix">
<h3>Pairwise Scatter-matrix<a class="headerlink" href="#pairwise-scatter-matrix" title="Permalink to this heading">#</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">warnings</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.cbook</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cbook</span><span class="o">.</span><span class="n">MatplotlibDeprecationWarning</span><span class="p">)</span>

<span class="ne">AttributeError</span>: module &#39;matplotlib.cbook&#39; has no attribute &#39;MatplotlibDeprecationWarning&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dummy-encoding">
<h3>Dummy Encoding<a class="headerlink" href="#dummy-encoding" title="Permalink to this heading">#</a></h3>
<p>To view the different values each categorical variable holds:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">X</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>League     [&#39;N&#39; &#39;A&#39;]
Division   [&#39;W&#39; &#39;E&#39;]
NewLeague  [&#39;N&#39; &#39;A&#39;]
</pre></div>
</div>
</div>
</div>
<p>And to “dummy encode” it is as simple as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;uint8&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_9b850_row0_col0, #T_9b850_row0_col1, #T_9b850_row0_col2, #T_9b850_row1_col0, #T_9b850_row1_col2, #T_9b850_row2_col0, #T_9b850_row2_col2, #T_9b850_row4_col1, #T_9b850_row6_col0, #T_9b850_row6_col1, #T_9b850_row7_col0, #T_9b850_row7_col2, #T_9b850_row9_col1, #T_9b850_row10_col0, #T_9b850_row10_col2, #T_9b850_row12_col1, #T_9b850_row13_col0, #T_9b850_row13_col1, #T_9b850_row13_col2, #T_9b850_row14_col1, #T_9b850_row15_col0, #T_9b850_row15_col2, #T_9b850_row16_col0, #T_9b850_row16_col1, #T_9b850_row17_col0, #T_9b850_row17_col1, #T_9b850_row17_col2, #T_9b850_row18_col0, #T_9b850_row18_col1, #T_9b850_row18_col2, #T_9b850_row19_col1 {
  background-color: #fff7fb;
  color: #000000;
}
#T_9b850_row1_col1, #T_9b850_row2_col1, #T_9b850_row3_col0, #T_9b850_row3_col1, #T_9b850_row3_col2, #T_9b850_row4_col0, #T_9b850_row4_col2, #T_9b850_row5_col0, #T_9b850_row5_col1, #T_9b850_row5_col2, #T_9b850_row6_col2, #T_9b850_row7_col1, #T_9b850_row8_col0, #T_9b850_row8_col1, #T_9b850_row8_col2, #T_9b850_row9_col0, #T_9b850_row9_col2, #T_9b850_row10_col1, #T_9b850_row11_col0, #T_9b850_row11_col1, #T_9b850_row11_col2, #T_9b850_row12_col0, #T_9b850_row12_col2, #T_9b850_row14_col0, #T_9b850_row14_col2, #T_9b850_row15_col1, #T_9b850_row16_col2, #T_9b850_row19_col0, #T_9b850_row19_col2 {
  background-color: #023858;
  color: #f1f1f1;
}
</style>
<table id="T_9b850_">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >League_N</th>
      <th class="col_heading level0 col1" >Division_W</th>
      <th class="col_heading level0 col2" >NewLeague_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_9b850_level0_row0" class="row_heading level0 row0" >-Pat Tabler</th>
      <td id="T_9b850_row0_col0" class="data row0 col0" >0</td>
      <td id="T_9b850_row0_col1" class="data row0 col1" >0</td>
      <td id="T_9b850_row0_col2" class="data row0 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row1" class="row_heading level0 row1" >-Tony Phillips</th>
      <td id="T_9b850_row1_col0" class="data row1 col0" >0</td>
      <td id="T_9b850_row1_col1" class="data row1 col1" >1</td>
      <td id="T_9b850_row1_col2" class="data row1 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row2" class="row_heading level0 row2" >-Mike Kingery</th>
      <td id="T_9b850_row2_col0" class="data row2 col0" >0</td>
      <td id="T_9b850_row2_col1" class="data row2 col1" >1</td>
      <td id="T_9b850_row2_col2" class="data row2 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row3" class="row_heading level0 row3" >-Craig Reynolds</th>
      <td id="T_9b850_row3_col0" class="data row3 col0" >1</td>
      <td id="T_9b850_row3_col1" class="data row3 col1" >1</td>
      <td id="T_9b850_row3_col2" class="data row3 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row4" class="row_heading level0 row4" >-Vance Law</th>
      <td id="T_9b850_row4_col0" class="data row4 col0" >1</td>
      <td id="T_9b850_row4_col1" class="data row4 col1" >0</td>
      <td id="T_9b850_row4_col2" class="data row4 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row5" class="row_heading level0 row5" >-Kal Daniels</th>
      <td id="T_9b850_row5_col0" class="data row5 col0" >1</td>
      <td id="T_9b850_row5_col1" class="data row5 col1" >1</td>
      <td id="T_9b850_row5_col2" class="data row5 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row6" class="row_heading level0 row6" >-Mike Easler</th>
      <td id="T_9b850_row6_col0" class="data row6 col0" >0</td>
      <td id="T_9b850_row6_col1" class="data row6 col1" >0</td>
      <td id="T_9b850_row6_col2" class="data row6 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row7" class="row_heading level0 row7" >-Darrell Porter</th>
      <td id="T_9b850_row7_col0" class="data row7 col0" >0</td>
      <td id="T_9b850_row7_col1" class="data row7 col1" >1</td>
      <td id="T_9b850_row7_col2" class="data row7 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row8" class="row_heading level0 row8" >-Carmelo Martinez</th>
      <td id="T_9b850_row8_col0" class="data row8 col0" >1</td>
      <td id="T_9b850_row8_col1" class="data row8 col1" >1</td>
      <td id="T_9b850_row8_col2" class="data row8 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row9" class="row_heading level0 row9" >-Herm Winningham</th>
      <td id="T_9b850_row9_col0" class="data row9 col0" >1</td>
      <td id="T_9b850_row9_col1" class="data row9 col1" >0</td>
      <td id="T_9b850_row9_col2" class="data row9 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row10" class="row_heading level0 row10" >-Kirby Puckett</th>
      <td id="T_9b850_row10_col0" class="data row10 col0" >0</td>
      <td id="T_9b850_row10_col1" class="data row10 col1" >1</td>
      <td id="T_9b850_row10_col2" class="data row10 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row11" class="row_heading level0 row11" >-Tony Gwynn</th>
      <td id="T_9b850_row11_col0" class="data row11 col0" >1</td>
      <td id="T_9b850_row11_col1" class="data row11 col1" >1</td>
      <td id="T_9b850_row11_col2" class="data row11 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row12" class="row_heading level0 row12" >-Tim Teufel</th>
      <td id="T_9b850_row12_col0" class="data row12 col0" >1</td>
      <td id="T_9b850_row12_col1" class="data row12 col1" >0</td>
      <td id="T_9b850_row12_col2" class="data row12 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row13" class="row_heading level0 row13" >-Tony Bernazard</th>
      <td id="T_9b850_row13_col0" class="data row13 col0" >0</td>
      <td id="T_9b850_row13_col1" class="data row13 col1" >0</td>
      <td id="T_9b850_row13_col2" class="data row13 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row14" class="row_heading level0 row14" >-Wally Backman</th>
      <td id="T_9b850_row14_col0" class="data row14 col0" >1</td>
      <td id="T_9b850_row14_col1" class="data row14 col1" >0</td>
      <td id="T_9b850_row14_col2" class="data row14 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row15" class="row_heading level0 row15" >-Gary Gaetti</th>
      <td id="T_9b850_row15_col0" class="data row15 col0" >0</td>
      <td id="T_9b850_row15_col1" class="data row15 col1" >1</td>
      <td id="T_9b850_row15_col2" class="data row15 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row16" class="row_heading level0 row16" >-Lance Parrish</th>
      <td id="T_9b850_row16_col0" class="data row16 col0" >0</td>
      <td id="T_9b850_row16_col1" class="data row16 col1" >0</td>
      <td id="T_9b850_row16_col2" class="data row16 col2" >1</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row17" class="row_heading level0 row17" >-Rey Quinones</th>
      <td id="T_9b850_row17_col0" class="data row17 col0" >0</td>
      <td id="T_9b850_row17_col1" class="data row17 col1" >0</td>
      <td id="T_9b850_row17_col2" class="data row17 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row18" class="row_heading level0 row18" >-Robin Yount</th>
      <td id="T_9b850_row18_col0" class="data row18 col0" >0</td>
      <td id="T_9b850_row18_col1" class="data row18 col1" >0</td>
      <td id="T_9b850_row18_col2" class="data row18 col2" >0</td>
    </tr>
    <tr>
      <th id="T_9b850_level0_row19" class="row_heading level0 row19" >-Terry Pendleton</th>
      <td id="T_9b850_row19_col0" class="data row19 col0" >1</td>
      <td id="T_9b850_row19_col1" class="data row19 col1" >0</td>
      <td id="T_9b850_row19_col2" class="data row19 col2" >1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="model-creation">
<h2>Model Creation<a class="headerlink" href="#model-creation" title="Permalink to this heading">#</a></h2>
<p>In the previous linear regression exercise we used <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code></a> class along with the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"><code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code></a> function to model the relationship between the features and the target variable and evaluate it’s performance in predicting the target variable for an out-of-sample collection of observations. In this exercise, we will use <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV"><code class="docutils literal notranslate"><span class="pre">LassoCV</span></code></a> and <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html"><code class="docutils literal notranslate"><span class="pre">RidgeCV</span></code></a> to introduce the <span class="math notranslate nohighlight">\(\ell_1\)</span> and <span class="math notranslate nohighlight">\(\ell_2\)</span> penalties as part of our fitting process and regularize the coefficients of our predictors. In addition, <a class="reference external" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)">cross-validation</a> will also be taken care of automatically.</p>
<p>For the sake of uniformity we’ll use the same list of regularization parameter values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">LassoCV</span></code> will use 5-fold cross-validation with <span class="math notranslate nohighlight">\(R^2\)</span> as the scoring method and <code class="docutils literal notranslate"><span class="pre">RidgeCV</span></code> will use Generalized Cross-Validation, which is a form of efficient Leave-One-Out cross-validation, with negative mean squared error.</p>
<p>To change the splitting strategy, set the <code class="docutils literal notranslate"><span class="pre">cv</span></code> keyword argument to the number of folds you’d like to use, to specify scoring and other search parameters see the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV"><code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a> class.</p>
</div>
</section>
<section id="model-application">
<h2>Model Application<a class="headerlink" href="#model-application" title="Permalink to this heading">#</a></h2>
<p>To calculate the predicted salary of each player using the model:</p>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="model-evaluation">
<h2>Model Evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">plot_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Real Values&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Predicted Values&quot;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lasso_predictions</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Lasso ($\ell_1$)&quot;</span><span class="p">)</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ridge_predictions</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Lasso ($\ell_2$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="alpha">
<h2>Alpha<a class="headerlink" href="#alpha" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<section id="coefficients">
<h3>Coefficients<a class="headerlink" href="#coefficients" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coefficients_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Lasso&quot;</span><span class="p">:</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="s2">&quot;Ridge&quot;</span><span class="p">:</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">}</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">coefficients_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">coefficients</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>League_N</th>
      <th>Division_W</th>
      <th>NewLeague_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lasso</th>
      <td>-237.2</td>
      <td>261.6</td>
      <td>0</td>
      <td>-0</td>
      <td>0</td>
      <td>104.8</td>
      <td>-46.64</td>
      <td>-0</td>
      <td>0</td>
      <td>44.29</td>
      <td>224.5</td>
      <td>123.9</td>
      <td>-144.8</td>
      <td>76.81</td>
      <td>26.48</td>
      <td>-13.56</td>
      <td>27.04</td>
      <td>-114.1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Ridge</th>
      <td>-216.4</td>
      <td>230.7</td>
      <td>0.9447</td>
      <td>0.7865</td>
      <td>6.002</td>
      <td>106.3</td>
      <td>-51.34</td>
      <td>-94.18</td>
      <td>119.4</td>
      <td>58.18</td>
      <td>199.9</td>
      <td>114.5</td>
      <td>-144.5</td>
      <td>77.68</td>
      <td>39.18</td>
      <td>-24.86</td>
      <td>50.73</td>
      <td>-118.6</td>
      <td>-18.02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span>


<span class="n">coef_fig</span><span class="p">,</span> <span class="n">coef_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1">#########</span>
<span class="c1"># Lasso #</span>
<span class="c1">#########</span>

<span class="n">simple_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span>
<span class="n">lasso_coefficient_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lasso_alphas</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">alphas_</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">lasso_alphas</span><span class="p">:</span>
    <span class="n">simple_lasso</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">simple_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">lasso_coefficient_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simple_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="c1"># Coefficient values by alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">lasso_alphas</span><span class="p">,</span> <span class="n">lasso_coefficient_values</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Chosen alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Coefficient Values&quot;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Lasso: Coefficient Values by $\alpha$&quot;</span><span class="p">)</span>

<span class="c1">#########</span>
<span class="c1"># Ridge #</span>
<span class="c1">#########</span>

<span class="n">simple_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">ridge_coefficient_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ridge_alphas</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">alphas</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">ridge_alphas</span><span class="p">:</span>
    <span class="n">simple_ridge</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">simple_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ridge_coefficient_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simple_ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>


<span class="c1"># Coefficient values by alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ridge_alphas</span><span class="p">,</span>
                   <span class="n">ridge_coefficient_values</span><span class="p">,</span>
                   <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Chosen alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">))</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Coefficient Values&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Ridge: Coefficient Values by $\alpha$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="mean-squared-error-mse">
<h3>Mean Squared Error (MSE)<a class="headerlink" href="#mean-squared-error-mse" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mse_fig</span><span class="p">,</span> <span class="n">mse_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1">#########</span>
<span class="c1"># Lasso #</span>
<span class="c1">#########</span>

<span class="n">lasso_alphas</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">alphas_</span>
<span class="n">lasso_mse</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">mse_path_</span>

<span class="c1"># Cross-validation MSEs</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">lasso_alphas</span><span class="p">,</span>
                   <span class="n">lasso_mse</span><span class="p">,</span>
                   <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Mean MSE</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lasso_alphas</span><span class="p">,</span>
               <span class="n">lasso_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
               <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mean MSE Across Folds&quot;</span><span class="p">,</span>
               <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Chosen alpha</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;MSE&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Lasso: Mean Squared Error (MSE) Across Folds&quot;</span><span class="p">)</span>

<span class="c1">#########</span>
<span class="c1"># Ridge #</span>
<span class="c1">#########</span>

<span class="n">ridge_alphas</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">alphas</span>
<span class="n">ridge_mse</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">cv_values_</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Cross-validation MSEs</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ridge_alphas</span><span class="p">,</span>
                   <span class="n">ridge_mse</span><span class="p">,</span>
                   <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="c1"># Mean MSE</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ridge_alphas</span><span class="p">,</span>
               <span class="n">ridge_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
               <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mean MSE Across Folds&quot;</span><span class="p">,</span>
               <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Chosen alpha</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;MSE&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ridge: Mean Squared Error (MSE) Across Folds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a1d51fdf14c4799af09deba825ad8747a61d8c13f91eec9621b233e7e23fc04a.png" src="../../_images/a1d51fdf14c4799af09deba825ad8747a61d8c13f91eec9621b233e7e23fc04a.png" />
</div>
</div>
</section>
<section id="r-2">
<h3><span class="math notranslate nohighlight">\(R^2\)</span><a class="headerlink" href="#r-2" title="Permalink to this heading">#</a></h3>
<p>To calculate in-sample <span class="math notranslate nohighlight">\(R^2\)</span> score for each model:</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Note that calculating in-sample <span class="math notranslate nohighlight">\(R^2\)</span> scores will result in underestimating prediction error.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a more generalized solution for parameter tuning, see <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV"><code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a>.</p>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/chapter_05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../chapter_04/exercise_04.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercise IV: Logistic Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="../chapter_06/exercise_06.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercise VI: Revisiting Linear and Logistic Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">Set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-inspection-and-preprocessing">General Inspection and Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-scatter-matrix">Pairwise Scatter-matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-encoding">Dummy Encoding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-creation">Model Creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-application">Model Application</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation">Model Evaluation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha">Alpha</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficients">Coefficients</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-squared-error-mse">Mean Squared Error (MSE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-2"><span class="math notranslate nohighlight">\(R^2\)</span></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr. Shlomi Lifshits, Gal Kepler, Zvi Baratz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>